{{=[[ ]]=}}
[[#i18n.yleiset]]
[[#i18n.arviointipaatokset]]
<div>
  <h3 ng-click="haeSuorituksia = !haeSuorituksia">[[hae_suorituksia]]</h3>

  <div ng-show="haeSuorituksia" style="border: 1px solid black; padding: 1em">

    <div>
      <fieldset>
        <input type="text" placeholder="[[hae_tutkinnon_suorittaja_placeholder]]" ng-model="hakuForm.suorittaja"></input>
      </fieldset>
    </div>
    <div>
      <fieldset>
       <label>[[toimikunta]]</label>
       <select ng-options="toimikunta.tkunta as toimikunta.diaarinumero + ' ' + (toimikunta | lokalisoiKentta:'nimi') for toimikunta in tutkintotoimikunnat" ng-model="hakuForm.toimikunta" required>
         <option value=""></option>
       </select>
      </fieldset>
    </div>
    <div>
      <fieldset>
        <label>[[suoritus_ehdotettu]]</label>
        <div>
          <pvm-valitsin pakollinen="false" valittu-pvm="hakuForm.ehdotuspvm_alku" max-pvm="hakuForm.ehdotuspvm_loppu" tyhjennettava="true"></pvm-valitsin>
          &nbsp;&nbsp;&nbsp;&nbsp;-
          <pvm-valitsin pakollinen="false" valittu-pvm="hakuForm.ehdotuspvm_loppu" min-pvm="hakuForm.ehdotuspvm_alku" tyhjennettava="true"></pvm-valitsin>
        </div>
        <div>
        </div>
      </fieldset>
      <fieldset>
        <label>[[tutkinto_jarjestaja]]</label>
        <select ng-model="hakuForm.koulutustoimija" ng-options="koulutustoimija.ytunnus as (koulutustoimija | lokalisoiKentta:'nimi') for koulutustoimija in koulutustoimijat">
          <option value=""></option>
        </select>
      </fieldset>
      <fieldset>
        <label>[[tutkinto]]</label>
        <select ng-model="hakuForm.tutkinto" ng-options="tutkinto.tutkintotunnus as tutkinto.tutkintotunnus + ' ' + (tutkinto | lokalisoiKentta:'nimi') for tutkinto in tutkinnot">
          <option value=""></option>
        </select>
      </fieldset>
    </div>
    <div>
      <fieldset>
        <label>[[suoritus_kirjattu]]</label>
        <div>
          <pvm-valitsin pakollinen="false" valittu-pvm="hakuForm.hyvaksymispvm_alku" max-pvm="hakuForm.hyvaksymispvm_loppu" tyhjennettava="true"></pvm-valitsin>
          &nbsp;&nbsp;&nbsp;&nbsp;-
          <pvm-valitsin pakollinen="false" valittu-pvm="hakuForm.hyvaksymispvm_loppu" min-pvm="hakuForm.hyvaksymispvm_alku" tyhjennettava="true"></pvm-valitsin>
        </div>
      </fieldset>
    </div>
    <div>
      <fieldset>
        <label>[[tutkinnon_osan_todistus]]</label>
        <select ng-model="hakuForm.todistus">
          <option ng-value="null"></option>
          <option value="todistus_ei">[[tutkinnon_osan_todistus_ei]]</option>
          <option value="todistus_kylla">[[tutkinnon_osan_todistus_kylla]]</option>
          <option value="todistus_kokotutkinto">[[tutkinnon_osan_todistus_kokotutkinto]]</option>
        </select>
      </fieldset>
      <fieldset>
        <label>[[suorituskieli]]</label>
        [[#i18n.enum.kieli-arvo]]
        <select ng-model="hakuForm.kieli">
          <option ng-value="null"></option>        
          <option value="fi">[[fi]]</option>
          <option value="sv">[[sv]]</option>
        </select>
        [[/i18n.enum.kieli-arvo]]
      </fieldset>      
    </div>
    <div>
      <fieldset>
        <label>[[rahoitusmuoto]]</label>
        <select ng-model="hakuForm.rahoitusmuoto" ng-options="rahoitusmuoto.rahoitusmuoto_id as rahoitusmuoto.rahoitusmuoto for rahoitusmuoto in rahoitusmuodot">
          <option value=""></option>
        </select>
      </fieldset>
      <fieldset>
        <label>[[jarjestamismuoto]]</label>
        <select ng-model="hakuForm.jarjestamismuoto">
          <option ng-value="null"></option>
          <option value="oppilaitosmuotoinen">[[oppilaitosmuotoinen]]</option>
          <option value="oppisopimuskoulutus">[[oppisopimuskoulutus]]</option>
          <option value="ei_valmistavaa_koulutusta">[[ei_valmistavaa_koulutusta]]</option>
        </select>
      </fieldset>
    </div>

  </div>

  <div>
    [[nayta]]:

    <label>
      <input type="radio" ng-model="hakuForm.tila" ng-value="null">
      [[kaikki]]
    </label>
    <label>
      <input type="radio" ng-model="hakuForm.tila" value="luonnos">
      [[luonnokset]]
    </label>
    <label>
      <input type="radio" ng-model="hakuForm.tila" value="ehdotettu">
      [[ehdotetut]]
    </label>
    <label>
      <input type="radio" ng-model="hakuForm.tila" value="hyvaksytty">
      [[hyvaksytyt]]
    </label>
  </div>

  <form name="suorituksetForm">
  <div class="table">
    <div class="table-header">
      <div class="table-cell">[[etunimi]]</div>
      <div class="table-cell">[[sukunimi]]</div>
      <div class="table-cell">[[tutkinto]]</div>
      <div class="table-cell">[[arvosana]]</div>
      <div class="table-cell">[[arviointikokouksen_pvm]]</div>
      <div class="table-cell">[[kirjauspaiva]]</div>
      <div class="table-cell">[[tutkinto_jarjestaja]]</div>
      <div class="table-cell">[[tila]]</div>
      <div class="table-cell">
        <span ng-if="hakuForm.tila === 'luonnos'">[[ehdota_hyvaksyttavaksi]]</span>
        <span ng-if="hakuForm.tila === 'ehdotettu'">[[hyvaksy]]/[[palauta_luonnokseksi]]</span>
        <span ng-if="hakuForm.tila === 'hyvaksytty'">[[palauta_hyvaksyttavaksi]]</span>
      </div>
    </div>
    <div class="table-row" ng-repeat="suoritus in suoritukset|filter:filterTila(hakuForm.tila)">
      <div class="table-cell">{{ suoritus.suorittaja_etunimi }}</div>
      <div class="table-cell">{{ suoritus.suorittaja_sukunimi }}</div>
      <div class="table-cell">{{ suoritus | lokalisoiKentta:'tutkinto_nimi' }}</div>
      <div class="table-cell">{{ suoritus.arvosana }}</div>
      <div class="table-cell">{{ suoritus.arviointikokouksen_pvm | date:'dd.MM.yyyy' }}</div>
      <div class="table-cell">{{ suoritus.hyvaksymisaika | date:'dd.MM.yyyy' }}</div>
      <div class="table-cell">{{ suoritus | lokalisoiKentta:'koulutustoimija_nimi' }}</div>
      <div class="table-cell">{{ i18n.arviointipaatokset['tila-' + suoritus.tila] }}</div>
      <div class="table-cell"><input type="checkbox" ng-model="form[suoritus.suorituskerta_id]" ng-if="hakuForm.tila === 'luonnos' || hakuForm.tila === 'ehdotettu' || hakuForm.tila === 'hyvaksytty'"></div>
      <div class="table-cell">
        <button class="icon edit-icon" ng-click="muokkaaSuoritusta(suoritus)" ng-if="suoritus.tila === 'luonnos'"></button>
        &nbsp;&nbsp;&nbsp;
        <button class="icon delete-icon" ng-click="poistaSuoritus(suoritus)" ng-if="suoritus.tila === 'luonnos'"></button>
      </div>
    </div>
  </div>

    <button class="float-right" ng-click="lahetaHyvaksyttavaksi()" ng-disabled="valitutSuoritukset().length == 0" ng-if="hakuForm.tila === 'luonnos'">[[laheta_hyvaksyttavaksi]]</button>
    <button class="float-right" ng-click="palautaLuonnokseksi()" ng-disabled="valitutSuoritukset().length == 0" ng-if="hakuForm.tila === 'ehdotettu'">[[palauta_luonnokseksi]]</button>
    <button class="float-right" ng-click="hyvaksy()" ng-disabled="valitutSuoritukset().length == 0" ng-if="hakuForm.tila === 'ehdotettu'">[[hyvaksy]]</button>
    <button class="float-right" ng-click="palautaHyvaksyttavaksi()" ng-disabled="valitutSuoritukset().length == 0" ng-if="hakuForm.tila === 'hyvaksytty'">[[palauta_hyvaksyttavaksi]]</button>
  </form>
</div>
[[/i18n.arviointipaatokset]]
[[/i18n.yleiset]]