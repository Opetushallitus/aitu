(ns ttk-db.tut-peruste)

; pohjana Excel-taulukko  http://www.oph.fi/download/158907_Peruslista_10_7_14_www.xlsx
; per rivi kÃ¤ytetty kaavaa =CONCATENATE("""";I309;""" {:peruste-diaari """;L309;"""}")
(def tut-perusteet
 {
"354301" {:peruste-diaari "7/011/2009"}"039996" {:peruste-diaari "15/011/2010"}"355201" {:peruste-diaari "26/011/2006"}"364308" {:peruste-diaari "68/011/2002"}"324101" {:peruste-diaari "50/011/2012"}"327101" {:peruste-diaari "51/011/2012"}"334117" {:peruste-diaari "48/011/2010"}"384201" {:peruste-diaari "42/011/2006"}"324601" {:peruste-diaari "41/011/2005"}"327302" {:peruste-diaari "42/011/2005"}"321602" {:peruste-diaari "32/011/2010"}"351301" {:peruste-diaari "30/011/2009"}"337108" {:peruste-diaari "39/011/2001"}"357305" {:peruste-diaari "40/011/2001"}"354302" {:peruste-diaari "52/011/2002"}"357301" {:peruste-diaari "53/011/2002"}"357302" {:peruste-diaari "54/011/2002"}"354307" {:peruste-diaari "55/011/2002"}"354401" {:peruste-diaari "3/011/2013"}"357401" {:peruste-diaari "9/011/2008"}"357304" {:peruste-diaari "38/011/2001"}"334101" {:peruste-diaari "66/011/2002"}"387101" {:peruste-diaari "40/011/2004"}"364304" {:peruste-diaari "3/011/2008"}"387102" {:peruste-diaari "44/011/2005"}"355505" {:peruste-diaari "47/011/2009"} "354402" {:peruste-diaari "50/011/2001"}"357402" {:peruste-diaari "51/011/2001"}"352101" {:peruste-diaari "20/011/2009"}"355104" {:peruste-diaari "36/011/2013"}"358103" {:peruste-diaari "48/011/2004"}"355105" {:peruste-diaari "33/011/2013"}"364902" {:peruste-diaari "40/011/2012"}"364904" {:peruste-diaari "25/011/2012"}"358508" {:peruste-diaari "41/011/2006"}"367201" {:peruste-diaari "35/011/2014"}"364201" {:peruste-diaari "10/011/2013"}"367904" {:peruste-diaari "15/011/2007"}"364901" {:peruste-diaari "40/011/2006"}"371109" {:peruste-diaari "12/011/2010"}"354312" {:peruste-diaari "48/011/2006"}"361104" {:peruste-diaari "24/011/2009"}"364101" {:peruste-diaari "34/011/2012"}"374111" {:peruste-diaari "30/011/2011"}"377101" {:peruste-diaari "47/011/2012"}"354111" {:peruste-diaari "21/011/2013"}"357101" {:peruste-diaari "44/011/2004"}"354101" {:peruste-diaari "46/011/2005"}"384301" {:peruste-diaari "12/011/2012"}"387304" {:peruste-diaari "42/011/2012"}"381303" {:peruste-diaari "27/011/2009"}"381112" {:peruste-diaari "3/011/2010"}"384101" {:peruste-diaari "13/011/2011"}"354201" {:peruste-diaari "29/011/2012"}"357201" {:peruste-diaari "19/011/2011"}"354212" {:peruste-diaari "27/011/2012"}"334103" {:peruste-diaari "8/011/2009"}"355411" {:peruste-diaari "38/011/2004"}"358410" {:peruste-diaari "37/011/2004"}"374117" {:peruste-diaari "61/011/2010"}"337101" {:peruste-diaari "15/011/2011"}"355501" {:peruste-diaari "48/011/2009"}"351107" {:peruste-diaari "28/011/2009"}"354113" {:peruste-diaari "55/011/2010"}"364401" {:peruste-diaari "19/011/2008"}"364402" {:peruste-diaari "54/011/2009"}"364403" {:peruste-diaari "26/011/2005"}"361401" {:peruste-diaari "22/011/2010"}"354202" {:peruste-diaari "30/011/2008"}"357203" {:peruste-diaari "47/011/2005"}"387303" {:peruste-diaari "31/011/2011"}"381304" {:peruste-diaari "26/011/2009"}"337102" {:peruste-diaari "40/011/2013"}"374122" {:peruste-diaari "49/011/2009"}"377108" {:peruste-diaari "28/011/2010"}"351106" {:peruste-diaari "27/011/2010"}"354601" {:peruste-diaari "31/011/2002"}"357601" {:peruste-diaari "24/011/2003"}"364103" {:peruste-diaari "25/011/2006"}"324104" {:peruste-diaari "73/011/1996"}"327104" {:peruste-diaari "52/011/97"}"354203" {:peruste-diaari "18/011/2013"}"357204" {:peruste-diaari "19/011/2013"}"334118" {:peruste-diaari "3/011/2011"}"351204" {:peruste-diaari "7/011/2010"}"374123" {:peruste-diaari "23/011/2011"}"377103" {:peruste-diaari "46/011/2012"}"358502" {:peruste-diaari "14/011/2005"}"355502" {:peruste-diaari "26/011/2002"}"354409" {:peruste-diaari "39/011/2009"}"354102" {:peruste-diaari " 17/011/2013"}"324105" {:peruste-diaari "67/011/1996"}"327105" {:peruste-diaari "54/011/1997"}"367905" {:peruste-diaari "51/011/2002"}"358101" {:peruste-diaari "12/011/2008"}"355101" {:peruste-diaari "10/011/2008"}"351101" {:peruste-diaari "39/011/2010"}"357102" {:peruste-diaari "23/011/2004"}"354103" {:peruste-diaari "46/011/2003"}"357103" {:peruste-diaari "61/011/2001"}"354104" {:peruste-diaari "49/011/2012"}"358503" {:peruste-diaari "45/011/2004"}"354801" {:peruste-diaari "9/011/2003"}"354403" {:peruste-diaari "98/011/2014"}"038411" {:peruste-diaari "20/011/2010"}"381113" {:peruste-diaari "25/011/2010"}"384114" {:peruste-diaari "11/011/2013"}"374124" {:peruste-diaari "63/011/2010"}"377106" {:peruste-diaari "32/011/2011"}"324107" {:peruste-diaari "35/011/2008"}"327107" {:peruste-diaari "34/011/2008"}"354602" {:peruste-diaari "34/011/2005"}"354115" {:peruste-diaari "56/011/2010"}"357109" {:peruste-diaari "57/011/2010"}"321301" {:peruste-diaari "13/011/2010"}"354205" {:peruste-diaari "21/011/2011"}"357207" {:peruste-diaari "7/011/2014"}"321101" {:peruste-diaari "25/011/2009"}"327128" {:peruste-diaari "34/011/2010"}"324128" {:peruste-diaari "19/011/2007"}"351603" {:peruste-diaari "19/011/2009"}"384103" {:peruste-diaari "12/011/2013"}"357111" {:peruste-diaari "13/011/2013"}"354114" {:peruste-diaari "16/011/2005"}"357405" {:peruste-diaari "37/011/2013"}"381204" {:peruste-diaari "18/011/2009"}"354605" {:peruste-diaari "31/011/2001"}"324109" {:peruste-diaari "31/011/2014"}"327109" {:peruste-diaari "32/011/2014"}"374118" {:peruste-diaari "7/011/2012"}"384401" {:peruste-diaari "38/011/2005"}"387401" {:peruste-diaari "40/011/2009"}"357803" {:peruste-diaari "25/011/2003"}"354802" {:peruste-diaari "12/011/2003"}"355410" {:peruste-diaari "4/011/2002"}"358408" {:peruste-diaari "5/011/2002"}"355108" {:peruste-diaari "25/011/2004"}"358102" {:peruste-diaari "13/011/2008"}"355102" {:peruste-diaari "11/011/2008"}"381410" {:peruste-diaari "26/011/2010"}"384405" {:peruste-diaari "16/011/2009"}"354313" {:peruste-diaari "21/011/2014"}"357307" {:peruste-diaari "22/011/2014"}"351307" {:peruste-diaari "38/011/2010"}"354702" {:peruste-diaari "28/011/2008"}"357702" {:peruste-diaari "33/011/2008"}"354105" {:peruste-diaari "20/011/2007"}"357104" {:peruste-diaari "6/011/2006"}"355103" {:peruste-diaari "41/011/2012"}"355110" {:peruste-diaari "4/011/2011"}"355106" {:peruste-diaari "26/011/2013"}"357303" {:peruste-diaari "12/011/2009"}"317101" {:peruste-diaari "8/011/2014"}"331101" {:peruste-diaari "34/011/2009"}"384204" {:peruste-diaari "2/011/2014"}"381203" {:peruste-diaari "21/011/2010"}"387201" {:peruste-diaari "47/011/2006"}"384202" {:peruste-diaari "49/011/2006"}"384402" {:peruste-diaari "16/011/2008"}"381408" {:peruste-diaari "32/011/2009"}"357105" {:peruste-diaari "17/011/2005"}"354106" {:peruste-diaari "3/011/2005"}"324110" {:peruste-diaari "45/011/2006"}"364906" {:peruste-diaari "27/011/2013"}"367901" {:peruste-diaari "121/011/1995"}"361902" {:peruste-diaari "31/011/2009"}"367301" {:peruste-diaari "25/011/97"}"354404" {:peruste-diaari "28/011/2007"}"371110" {:peruste-diaari "19/011/2010"}"039998" {:peruste-diaari "7/011/2008"}"357802" {:peruste-diaari "14/011/2003"}"354803" {:peruste-diaari "34/011/2013"}"355301" {:peruste-diaari "28/011/2012"}"352301" {:peruste-diaari "5/011/2010"}"355210" {:peruste-diaari "55/011/2012"}"358206" {:peruste-diaari "28/011/2013"}"367903" {:peruste-diaari "16/011/2011"}"367102" {:peruste-diaari "8/011/2004"}"364905" {:peruste-diaari "50/011/2004"}"361101" {:peruste-diaari "29/011/2009"}"354311" {:peruste-diaari "18/011/2008"}"355107" {:peruste-diaari "59/011/2010"}"387103" {:peruste-diaari "23/011/2012"}"334104" {:peruste-diaari "52/011/2009"}"337110" {:peruste-diaari "41/011/2013"}"381106" {:peruste-diaari "21/011/2009"}"384111" {:peruste-diaari "29/011/2006"}"384112" {:peruste-diaari "12/011/2011"}"384110" {:peruste-diaari "14/011/2011"}"364109" {:peruste-diaari "26/011/2004"}"355109" {:peruste-diaari "23/011/2010"}"381402" {:peruste-diaari "36/011/2010"}"354110" {:peruste-diaari "23/011/2003"}"364301" {:peruste-diaari "7/011/2013"}"364305" {:peruste-diaari "43/011/2012"}"367302" {:peruste-diaari "17/011/2004"}"361301" {:peruste-diaari "36/011/2009"}"364302" {:peruste-diaari "46/011/2006"}"355905" {:peruste-diaari "45/011/2012"}"352902" {:peruste-diaari "1/011/2010"}"354603" {:peruste-diaari "29/011/2013"}"357603" {:peruste-diaari "30/011/2013"}"321204" {:peruste-diaari "30/011/2010"}"334105" {:peruste-diaari "11/011/2012"}"358409" {:peruste-diaari "49/011/2004"}"357205" {:peruste-diaari "24/011/2002"}"354206" {:peruste-diaari "25/011/2002"}"381201" {:peruste-diaari "17/011/2009"}"377109" {:peruste-diaari "18/011/2012"}"374121" {:peruste-diaari "44/011/2009"}"387203" {:peruste-diaari "14/011/2013"}"374119" {:peruste-diaari "9/011/2004"}"358504" {:peruste-diaari "46/011/2004"}"355503" {:peruste-diaari "46/011/2009"}"355504" {:peruste-diaari "45/011/2009"}"352503" {:peruste-diaari "31/011/2010"}"354604" {:peruste-diaari "13/011/2007"}"357602" {:peruste-diaari "13/011/2007"}"374114" {:peruste-diaari "15/011/2013"}"387106" {:peruste-diaari "34/011/2014"}"354309" {:peruste-diaari "19/011/2004"}"351805" {:peruste-diaari "37/011/2010"}"357801" {:peruste-diaari "11/011/2003"}"364105" {:peruste-diaari "24/011/2007"}"351605" {:peruste-diaari "4/011/2010"}"377104" {:peruste-diaari "43/011/2009"}"377102" {:peruste-diaari "60/011/2010"}"367203" {:peruste-diaari "51/011/2000"}"364202" {:peruste-diaari "15/011/2005"}"354207" {:peruste-diaari "26/011/2012"}"357206" {:peruste-diaari "20/011/2011"}"351701" {:peruste-diaari "33/011/2010"}"367304" {:peruste-diaari "8/011/2013"}"354710" {:peruste-diaari "36/011/2008"}"357709" {:peruste-diaari "100/011/2014"}"361201" {:peruste-diaari "2/011/2010"}"364307" {:peruste-diaari "27/011/2008"}"374115" {:peruste-diaari "2/011/2013"}"352201" {:peruste-diaari "35/011/2009"}"358204" {:peruste-diaari "43/011/2010"}"357110" {:peruste-diaari "26/011/2007"}"354107" {:peruste-diaari "27/011/2007"}"355208" {:peruste-diaari "54/011/2004"}"355211" {:peruste-diaari "18/011/2011"}"354310" {:peruste-diaari "21/011/2008"}"364108" {:peruste-diaari "30/011/2012"}"367103" {:peruste-diaari "28/011/2005"}"355903" {:peruste-diaari "21/011/2007"}"384109" {:peruste-diaari "25/011/2011"}"354314" {:peruste-diaari "37/011/2012"}"324115" {:peruste-diaari "36/011/2011"}"327114" {:peruste-diaari "35/011/2011"}"367902" {:peruste-diaari "53/011/2009"}"324116" {:peruste-diaari "6/011/2013"}"327115" {:peruste-diaari "52/011/2010"}"358505" {:peruste-diaari "46/011/2004"}"337104" {:peruste-diaari "24/011/2014"}"324201" {:peruste-diaari "13/011/2009"}"324117" {:peruste-diaari "27/011/2006"}"327116" {:peruste-diaari "28/011/2006"}"354705" {:peruste-diaari "24/011/2008"}"357705" {:peruste-diaari "25/011/2008"}"364106" {:peruste-diaari "14/011/2014"}"324119" {:peruste-diaari "1/011/2007"}"327118" {:peruste-diaari "2/011/2007"}"334106" {:peruste-diaari "19/011/2012"}"387105" {:peruste-diaari "37/011/2005"}"387104" {:peruste-diaari "36/011/2005"}"321902" {:peruste-diaari "24/011/2010"}"324129" {:peruste-diaari "38/011/2013"}"327127" {:peruste-diaari "26/011/2008"}"358506" {:peruste-diaari "47/011/2004"}"324120" {:peruste-diaari "32/011/2007"}"327119" {:peruste-diaari "33/011/2007"}"371101" {:peruste-diaari "17/011/2010"}"384203" {:peruste-diaari "8/011/2012"}"352903" {:peruste-diaari "8/011/2010"}"355901" {:peruste-diaari "2/011/2008"}"384108" {:peruste-diaari "26/011/2011"}"351407" {:peruste-diaari "23/011/2009"}"354405" {:peruste-diaari "54/011/2010"}"354407" {:peruste-diaari "22/011/2013"}"357403" {:peruste-diaari "5/011/2011"}"354406" {:peruste-diaari "17/011/2012"}"357404" {:peruste-diaari "53/011/2010"}"367104" {:peruste-diaari "21/011/2005"}"355209" {:peruste-diaari "25/011/2014"}"358205" {:peruste-diaari "2/011/2011"}"351203" {:peruste-diaari "35/011/2010"}"334114" {:peruste-diaari "10/011/2012"}"337109" {:peruste-diaari "29/011/2007"}"321501" {:peruste-diaari "29/011/2010"}"367101" {:peruste-diaari "38/011/2006"}"384106" {:peruste-diaari "39/011/2004"}"324502" {:peruste-diaari "18/011/2005"}"327503" {:peruste-diaari "19/011/2005"}"358901" {:peruste-diaari "5/011/2009"}"354209" {:peruste-diaari "20/011/2008"}"352401" {:peruste-diaari "6/011/2009"}"355412" {:peruste-diaari "22/011/2011"}"358411" {:peruste-diaari "99/011/2014"}"384113" {:peruste-diaari "33/011/2014"}"354804" {:peruste-diaari "10/011/2003"}"354211" {:peruste-diaari "61/011/2000"}"334113" {:peruste-diaari "3/011/2014"}"354503" {:peruste-diaari "96/011/2014"}"357503" {:peruste-diaari "97/011/2014"}"351502" {:peruste-diaari "22/011/2009"}"344101" {:peruste-diaari "58/011/2010"}"347101" {:peruste-diaari "17/011/2011"}"341101" {:peruste-diaari "16/011/2010"}"354501" {:peruste-diaari "32/011/2006"}"357501" {:peruste-diaari "31/011/2006"}"354502" {:peruste-diaari "30/011/2005"}"357502" {:peruste-diaari "31/011/2005"}"334119" {:peruste-diaari "55/011/2009"}"364102" {:peruste-diaari "31/011/2012"}"358902" {:peruste-diaari "35/011/2007"}"358405" {:peruste-diaari "29/011/2002"}"355407" {:peruste-diaari "28/011/2002"}"381504" {:peruste-diaari "18/011/2010"}"387501" {:peruste-diaari "21/011/2003"}"355906" {:peruste-diaari "15/011/2014"}"377110" {:peruste-diaari "33/011/2011"}"357106" {:peruste-diaari "10/011/2007"}"354112" {:peruste-diaari "13/011/2002"}"334102" {:peruste-diaari "39/011/2012"}"337106" {:peruste-diaari "22/011/2005"}"355413" {:peruste-diaari "5/011/2005"}"358412" {:peruste-diaari "4/011/2005"}"357107" {:peruste-diaari "11/011/2006"}"354108" {:peruste-diaari "9/011/2006"}"384205" {:peruste-diaari "15/011/2006"}"387202" {:peruste-diaari "50/011/2006"}"324301" {:peruste-diaari "12/011/2006"}"327301" {:peruste-diaari "51/011/2006"}"357108" {:peruste-diaari "5/011/2006"}"354109" {:peruste-diaari "4/011/2006"}"039999" {:peruste-diaari "9/011/2010"}"377105" {:peruste-diaari "16/011/2013"}"334108" {:peruste-diaari "65/011/2002"}"334109" {:peruste-diaari "30/011/2006"}"357306" {:peruste-diaari "20/011/2005"}"384501" {:peruste-diaari "44/011/2006"}"351703" {:peruste-diaari "33/011/2009"}"354708" {:peruste-diaari "53/011/2001"}"357707" {:peruste-diaari "53/011/2001"}"357708" {:peruste-diaari "28/011/2011"}"354709" {:peruste-diaari "27/011/2011"}"351704" {:peruste-diaari "37/011/2009"}"355212" {:peruste-diaari "8/011/2006"}"334116" {:peruste-diaari "9/011/2009"}"337111" {:peruste-diaari "14/011/2008"}"364205" {:peruste-diaari "13/011/2012"}"364203" {:peruste-diaari "19/011/2006"}"321901" {:peruste-diaari "57/011/2009"}"364107" {:peruste-diaari "32/011/2012"}"364204" {:peruste-diaari "11/011/2007"}"334111" {:peruste-diaari "8/011/2011"}"354408" {:peruste-diaari "16/011/2012"}"374113" {:peruste-diaari "29/011/2011"}"377107" {:peruste-diaari "2/011/2006"}"384403" {:peruste-diaari "15/011/2008"}"358904" {:peruste-diaari "54/011/2012"}"355902" {:peruste-diaari "12/011/2007"}"334112" {:peruste-diaari "53/011/2012"}"337107" {:peruste-diaari "4/011/2008"}"337112" {:peruste-diaari "46/011/2010"}
})

(defn generoi-sql []
  (println "set session aitu.kayttaja='INTEGRAATIO';")
  (println)
  (doseq [tutv tut-perusteet ]
    (let [tutkinto (first tutv)
          diaarinumero (:peruste-diaari (second tutv))]
      (println (str "insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, voimassa_loppupvm, siirtymaajan_loppupvm, jarjestyskoodistoversio, osajarjestyskoodisto) "
                "  select tutkintotunnus, 2 as versio, koodistoversio, '" diaarinumero "' as peruste, hyvaksytty, (select DATE 'yesterday'), voimassa_loppupvm, siirtymaajan_loppupvm, jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio "
                "    where tutkintotunnus = '" tutkinto "' and versio = 1;"))
      (println (str "update tutkintoversio set voimassa_loppupvm = (select DATE 'yesterday') where tutkintotunnus='" tutkinto "' and versio=1;"))
      (println (str "update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio where versio = 2 and tutkintotunnus = '" tutkinto "') where tutkintotunnus = '" tutkinto "';"))
      (println)
      )))

