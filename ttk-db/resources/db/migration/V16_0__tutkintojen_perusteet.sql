set session aitu.kayttaja='INTEGRAATIO';

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '73/011/1996' as peruste, hyvaksytty, DATE '1996-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324104' and versio = 1 and peruste != '73/011/1996';
update tutkintoversio set voimassa_loppupvm = (DATE '1996-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1996-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324104' and versio=1 and peruste != '73/011/1996';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324104' and versio > tv.versio)) where tutkintotunnus = '324104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2005' as peruste, hyvaksytty, DATE '2005-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327503' and versio = 1 and peruste != '19/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327503' and versio=1 and peruste != '19/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327503' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327503' and versio > tv.versio)) where tutkintotunnus = '327503';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324115' and versio = 1 and peruste != '36/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324115' and versio=1 and peruste != '36/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324115' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324115' and versio > tv.versio)) where tutkintotunnus = '324115';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '22/011/2005' as peruste, hyvaksytty, DATE '2005-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337106' and versio = 1 and peruste != '22/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337106' and versio=1 and peruste != '22/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337106' and versio > tv.versio)) where tutkintotunnus = '337106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2008' as peruste, hyvaksytty, DATE '2008-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327107' and versio = 1 and peruste != '34/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327107' and versio=1 and peruste != '34/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327107' and versio > tv.versio)) where tutkintotunnus = '327107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2007' as peruste, hyvaksytty, DATE '2007-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327118' and versio = 1 and peruste != '2/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327118' and versio=1 and peruste != '2/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327118' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327118' and versio > tv.versio)) where tutkintotunnus = '327118';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '44/011/2009' as peruste, hyvaksytty, DATE '2009-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374121' and versio = 1 and peruste != '44/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374121' and versio=1 and peruste != '44/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374121' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374121' and versio > tv.versio)) where tutkintotunnus = '374121';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387101' and versio = 1 and peruste != '40/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387101' and versio=1 and peruste != '40/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387101' and versio > tv.versio)) where tutkintotunnus = '387101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2008' as peruste, hyvaksytty, DATE '2008-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354310' and versio = 1 and peruste != '21/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354310' and versio=1 and peruste != '21/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354310' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354310' and versio > tv.versio)) where tutkintotunnus = '354310';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2002' as peruste, hyvaksytty, DATE '2002-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355410' and versio = 1 and peruste != '4/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355410' and versio=1 and peruste != '4/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355410' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355410' and versio > tv.versio)) where tutkintotunnus = '355410';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '61/011/2000' as peruste, hyvaksytty, DATE '2000-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354211' and versio = 1 and peruste != '61/011/2000';
update tutkintoversio set voimassa_loppupvm = (DATE '2000-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2000-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354211' and versio=1 and peruste != '61/011/2000';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354211' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354211' and versio > tv.versio)) where tutkintotunnus = '354211';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2005' as peruste, hyvaksytty, DATE '2006-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354101' and versio = 1 and peruste != '46/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354101' and versio=1 and peruste != '46/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354101' and versio > tv.versio)) where tutkintotunnus = '354101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '039996' and versio = 1 and peruste != '15/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='039996' and versio=1 and peruste != '15/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '039996' and not exists (select 1 from tutkintoversio where tutkintotunnus = '039996' and versio > tv.versio)) where tutkintotunnus = '039996';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2006' as peruste, hyvaksytty, DATE '2006-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355201' and versio = 1 and peruste != '26/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355201' and versio=1 and peruste != '26/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355201' and versio > tv.versio)) where tutkintotunnus = '355201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/97' as peruste, hyvaksytty, DATE '1997-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367301' and versio = 1 and peruste != '25/011/97';
update tutkintoversio set voimassa_loppupvm = (DATE '1997-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1997-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367301' and versio=1 and peruste != '25/011/97';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367301' and versio > tv.versio)) where tutkintotunnus = '367301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2002' as peruste, hyvaksytty, DATE '2002-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354112' and versio = 1 and peruste != '13/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354112' and versio=1 and peruste != '13/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354112' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354112' and versio > tv.versio)) where tutkintotunnus = '354112';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '60/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377102' and versio = 1 and peruste != '60/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377102' and versio=1 and peruste != '60/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377102' and versio > tv.versio)) where tutkintotunnus = '377102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2006' as peruste, hyvaksytty, DATE '2006-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355212' and versio = 1 and peruste != '8/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355212' and versio=1 and peruste != '8/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355212' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355212' and versio > tv.versio)) where tutkintotunnus = '355212';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321101' and versio = 1 and peruste != '25/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321101' and versio=1 and peruste != '25/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321101' and versio > tv.versio)) where tutkintotunnus = '321101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2008' as peruste, hyvaksytty, DATE '2008-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357401' and versio = 1 and peruste != '9/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357401' and versio=1 and peruste != '9/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357401' and versio > tv.versio)) where tutkintotunnus = '357401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355102' and versio = 1 and peruste != '11/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355102' and versio=1 and peruste != '11/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355102' and versio > tv.versio)) where tutkintotunnus = '355102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/2002' as peruste, hyvaksytty, DATE '2002-10-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357302' and versio = 1 and peruste != '54/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357302' and versio=1 and peruste != '54/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357302' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357302' and versio > tv.versio)) where tutkintotunnus = '357302';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2005' as peruste, hyvaksytty, DATE '2005-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367103' and versio = 1 and peruste != '28/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367103' and versio=1 and peruste != '28/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367103' and versio > tv.versio)) where tutkintotunnus = '367103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '47/011/2005' as peruste, hyvaksytty, DATE '2006-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357203' and versio = 1 and peruste != '47/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357203' and versio=1 and peruste != '47/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357203' and versio > tv.versio)) where tutkintotunnus = '357203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2009' as peruste, hyvaksytty, DATE '2009-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334103' and versio = 1 and peruste != '8/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334103' and versio=1 and peruste != '8/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334103' and versio > tv.versio)) where tutkintotunnus = '334103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2012' as peruste, hyvaksytty, DATE '2012-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334114' and versio = 1 and peruste != '10/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334114' and versio=1 and peruste != '10/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334114' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334114' and versio > tv.versio)) where tutkintotunnus = '334114';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '6/011/2006' as peruste, hyvaksytty, DATE '2006-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357104' and versio = 1 and peruste != '6/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357104' and versio=1 and peruste != '6/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357104' and versio > tv.versio)) where tutkintotunnus = '357104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '43/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358204' and versio = 1 and peruste != '43/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358204' and versio=1 and peruste != '43/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358204' and versio > tv.versio)) where tutkintotunnus = '358204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '67/011/1996' as peruste, hyvaksytty, DATE '1996-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324105' and versio = 1 and peruste != '67/011/1996';
update tutkintoversio set voimassa_loppupvm = (DATE '1996-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1996-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324105' and versio=1 and peruste != '67/011/1996';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324105' and versio > tv.versio)) where tutkintotunnus = '324105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '6/011/2013' as peruste, hyvaksytty, DATE '2013-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324116' and versio = 1 and peruste != '6/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324116' and versio=1 and peruste != '6/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324116' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324116' and versio > tv.versio)) where tutkintotunnus = '324116';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2008' as peruste, hyvaksytty, DATE '2008-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337107' and versio = 1 and peruste != '4/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337107' and versio=1 and peruste != '4/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337107' and versio > tv.versio)) where tutkintotunnus = '337107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384110' and versio = 1 and peruste != '14/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384110' and versio=1 and peruste != '14/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384110' and versio > tv.versio)) where tutkintotunnus = '384110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327119' and versio = 1 and peruste != '33/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327119' and versio=1 and peruste != '33/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327119' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327119' and versio > tv.versio)) where tutkintotunnus = '327119';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374111' and versio = 1 and peruste != '30/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374111' and versio=1 and peruste != '30/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374111' and versio > tv.versio)) where tutkintotunnus = '374111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '49/011/2009' as peruste, hyvaksytty, DATE '2009-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374122' and versio = 1 and peruste != '49/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374122' and versio=1 and peruste != '49/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374122' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374122' and versio > tv.versio)) where tutkintotunnus = '374122';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '47/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387201' and versio = 1 and peruste != '47/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387201' and versio=1 and peruste != '47/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387201' and versio > tv.versio)) where tutkintotunnus = '387201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2012' as peruste, hyvaksytty, DATE '2012-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364101' and versio = 1 and peruste != '34/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364101' and versio=1 and peruste != '34/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364101' and versio > tv.versio)) where tutkintotunnus = '364101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '44/011/2005' as peruste, hyvaksytty, DATE '2005-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387102' and versio = 1 and peruste != '44/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387102' and versio=1 and peruste != '44/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387102' and versio > tv.versio)) where tutkintotunnus = '387102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2008' as peruste, hyvaksytty, DATE '2008-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354311' and versio = 1 and peruste != '18/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354311' and versio=1 and peruste != '18/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354311' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354311' and versio > tv.versio)) where tutkintotunnus = '354311';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355411' and versio = 1 and peruste != '38/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355411' and versio=1 and peruste != '38/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355411' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355411' and versio > tv.versio)) where tutkintotunnus = '355411';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354201' and versio = 1 and peruste != '29/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354201' and versio=1 and peruste != '29/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354201' and versio > tv.versio)) where tutkintotunnus = '354201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '331101' and versio = 1 and peruste != '34/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='331101' and versio=1 and peruste != '34/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '331101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '331101' and versio > tv.versio)) where tutkintotunnus = '331101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355301' and versio = 1 and peruste != '28/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355301' and versio=1 and peruste != '28/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355301' and versio > tv.versio)) where tutkintotunnus = '355301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354212' and versio = 1 and peruste != '27/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354212' and versio=1 and peruste != '27/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354212' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354212' and versio > tv.versio)) where tutkintotunnus = '354212';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, ' 17/011/2013' as peruste, hyvaksytty, DATE '2013-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354102' and versio = 1 and peruste != ' 17/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354102' and versio=1 and peruste != ' 17/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354102' and versio > tv.versio)) where tutkintotunnus = '354102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2006' as peruste, hyvaksytty, DATE '2006-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357501' and versio = 1 and peruste != '31/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357501' and versio=1 and peruste != '31/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357501' and versio > tv.versio)) where tutkintotunnus = '357501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2004' as peruste, hyvaksytty, DATE '2004-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367302' and versio = 1 and peruste != '17/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367302' and versio=1 and peruste != '17/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367302' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367302' and versio > tv.versio)) where tutkintotunnus = '367302';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '55/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354113' and versio = 1 and peruste != '55/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354113' and versio=1 and peruste != '55/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354113' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354113' and versio > tv.versio)) where tutkintotunnus = '354113';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377103' and versio = 1 and peruste != '46/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377103' and versio=1 and peruste != '46/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377103' and versio > tv.versio)) where tutkintotunnus = '377103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '51/011/2001' as peruste, hyvaksytty, DATE '2001-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357402' and versio = 1 and peruste != '51/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357402' and versio=1 and peruste != '51/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357402' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357402' and versio > tv.versio)) where tutkintotunnus = '357402';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '41/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355103' and versio = 1 and peruste != '41/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355103' and versio=1 and peruste != '41/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355103' and versio > tv.versio)) where tutkintotunnus = '355103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '51/011/2000' as peruste, hyvaksytty, DATE '2000-08-14', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367203' and versio = 1 and peruste != '51/011/2000';
update tutkintoversio set voimassa_loppupvm = (DATE '2000-08-14' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2000-08-14' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367203' and versio=1 and peruste != '51/011/2000';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367203' and versio > tv.versio)) where tutkintotunnus = '367203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2005' as peruste, hyvaksytty, DATE '2005-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358502' and versio = 1 and peruste != '14/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358502' and versio=1 and peruste != '14/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358502' and versio > tv.versio)) where tutkintotunnus = '358502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2009' as peruste, hyvaksytty, DATE '2009-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357303' and versio = 1 and peruste != '12/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357303' and versio=1 and peruste != '12/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357303' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357303' and versio > tv.versio)) where tutkintotunnus = '357303';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2005' as peruste, hyvaksytty, DATE '2005-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367104' and versio = 1 and peruste != '21/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367104' and versio=1 and peruste != '21/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367104' and versio > tv.versio)) where tutkintotunnus = '367104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357204' and versio = 1 and peruste != '19/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357204' and versio=1 and peruste != '19/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357204' and versio > tv.versio)) where tutkintotunnus = '357204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '52/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334104' and versio = 1 and peruste != '52/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334104' and versio=1 and peruste != '52/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334104' and versio > tv.versio)) where tutkintotunnus = '334104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2010' as peruste, hyvaksytty, DATE '2010-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334115' and versio = 1 and peruste != '10/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334115' and versio=1 and peruste != '10/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334115' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334115' and versio > tv.versio)) where tutkintotunnus = '334115';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2005' as peruste, hyvaksytty, DATE '2005-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357105' and versio = 1 and peruste != '17/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357105' and versio=1 and peruste != '17/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357105' and versio > tv.versio)) where tutkintotunnus = '357105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2011' as peruste, hyvaksytty, DATE '2011-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358205' and versio = 1 and peruste != '2/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358205' and versio=1 and peruste != '2/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358205' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358205' and versio > tv.versio)) where tutkintotunnus = '358205';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2006' as peruste, hyvaksytty, DATE '2006-08-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324117' and versio = 1 and peruste != '27/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324117' and versio=1 and peruste != '27/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324117' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324117' and versio > tv.versio)) where tutkintotunnus = '324117';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2007' as peruste, hyvaksytty, DATE '2007-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324128' and versio = 1 and peruste != '19/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324128' and versio=1 and peruste != '19/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324128' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324128' and versio > tv.versio)) where tutkintotunnus = '324128';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '39/011/2001' as peruste, hyvaksytty, DATE '2001-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337108' and versio = 1 and peruste != '39/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337108' and versio=1 and peruste != '39/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337108' and versio > tv.versio)) where tutkintotunnus = '337108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2006' as peruste, hyvaksytty, DATE '2006-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384111' and versio = 1 and peruste != '29/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384111' and versio=1 and peruste != '29/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384111' and versio > tv.versio)) where tutkintotunnus = '384111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364201' and versio = 1 and peruste != '10/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364201' and versio=1 and peruste != '10/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364201' and versio > tv.versio)) where tutkintotunnus = '364201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374123' and versio = 1 and peruste != '23/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374123' and versio=1 and peruste != '23/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374123' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374123' and versio > tv.versio)) where tutkintotunnus = '374123';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352101' and versio = 1 and peruste != '20/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352101' and versio=1 and peruste != '20/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352101' and versio > tv.versio)) where tutkintotunnus = '352101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '50/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387202' and versio = 1 and peruste != '50/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387202' and versio=1 and peruste != '50/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387202' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387202' and versio > tv.versio)) where tutkintotunnus = '387202';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '341101' and versio = 1 and peruste != '16/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='341101' and versio=1 and peruste != '16/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '341101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '341101' and versio > tv.versio)) where tutkintotunnus = '341101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2009' as peruste, hyvaksytty, DATE '2009-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354301' and versio = 1 and peruste != '7/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354301' and versio=1 and peruste != '7/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354301' and versio > tv.versio)) where tutkintotunnus = '354301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364102' and versio = 1 and peruste != '31/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364102' and versio=1 and peruste != '31/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364102' and versio > tv.versio)) where tutkintotunnus = '364102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387103' and versio = 1 and peruste != '23/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387103' and versio=1 and peruste != '23/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387103' and versio > tv.versio)) where tutkintotunnus = '387103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '48/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354312' and versio = 1 and peruste != '48/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354312' and versio=1 and peruste != '48/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354312' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354312' and versio > tv.versio)) where tutkintotunnus = '354312';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '22/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355412' and versio = 1 and peruste != '22/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355412' and versio=1 and peruste != '22/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355412' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355412' and versio > tv.versio)) where tutkintotunnus = '355412';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2008' as peruste, hyvaksytty, DATE '2008-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354202' and versio = 1 and peruste != '30/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354202' and versio=1 and peruste != '30/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354202' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354202' and versio > tv.versio)) where tutkintotunnus = '354202';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321301' and versio = 1 and peruste != '13/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321301' and versio=1 and peruste != '13/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321301' and versio > tv.versio)) where tutkintotunnus = '321301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2003' as peruste, hyvaksytty, DATE '2003-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357601' and versio = 1 and peruste != '24/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357601' and versio=1 and peruste != '24/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357601' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357601' and versio > tv.versio)) where tutkintotunnus = '357601';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2003' as peruste, hyvaksytty, DATE '2004-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354103' and versio = 1 and peruste != '46/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354103' and versio=1 and peruste != '46/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354103' and versio > tv.versio)) where tutkintotunnus = '354103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2008' as peruste, hyvaksytty, DATE '2008-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '039998' and versio = 1 and peruste != '7/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='039998' and versio=1 and peruste != '7/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '039998' and not exists (select 1 from tutkintoversio where tutkintotunnus = '039998' and versio > tv.versio)) where tutkintotunnus = '039998';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2005' as peruste, hyvaksytty, DATE '2005-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357502' and versio = 1 and peruste != '31/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357502' and versio=1 and peruste != '31/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357502' and versio > tv.versio)) where tutkintotunnus = '357502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2005' as peruste, hyvaksytty, DATE '2005-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354114' and versio = 1 and peruste != '16/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354114' and versio=1 and peruste != '16/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354114' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354114' and versio > tv.versio)) where tutkintotunnus = '354114';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '43/011/2009' as peruste, hyvaksytty, DATE '2009-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377104' and versio = 1 and peruste != '43/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377104' and versio=1 and peruste != '43/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377104' and versio > tv.versio)) where tutkintotunnus = '377104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '41/011/2005' as peruste, hyvaksytty, DATE '2006-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324601' and versio = 1 and peruste != '41/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324601' and versio=1 and peruste != '41/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324601' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324601' and versio > tv.versio)) where tutkintotunnus = '324601';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2011' as peruste, hyvaksytty, DATE '2011-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357403' and versio = 1 and peruste != '5/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357403' and versio=1 and peruste != '5/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357403' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357403' and versio > tv.versio)) where tutkintotunnus = '357403';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355104' and versio = 1 and peruste != '36/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355104' and versio=1 and peruste != '36/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355104' and versio > tv.versio)) where tutkintotunnus = '355104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2005' as peruste, hyvaksytty, DATE '2005-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324502' and versio = 1 and peruste != '18/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324502' and versio=1 and peruste != '18/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324502' and versio > tv.versio)) where tutkintotunnus = '324502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '45/011/2004' as peruste, hyvaksytty, DATE '2004-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358503' and versio = 1 and peruste != '45/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358503' and versio=1 and peruste != '45/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358503' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358503' and versio > tv.versio)) where tutkintotunnus = '358503';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2001' as peruste, hyvaksytty, DATE '2001-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357304' and versio = 1 and peruste != '38/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357304' and versio=1 and peruste != '38/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357304' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357304' and versio > tv.versio)) where tutkintotunnus = '357304';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2002' as peruste, hyvaksytty, DATE '2002-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357205' and versio = 1 and peruste != '24/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357205' and versio=1 and peruste != '24/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357205' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357205' and versio > tv.versio)) where tutkintotunnus = '357205';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2012' as peruste, hyvaksytty, DATE '2012-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334105' and versio = 1 and peruste != '11/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334105' and versio=1 and peruste != '11/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334105' and versio > tv.versio)) where tutkintotunnus = '334105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2009' as peruste, hyvaksytty, DATE '2009-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334116' and versio = 1 and peruste != '9/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334116' and versio=1 and peruste != '9/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334116' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334116' and versio > tv.versio)) where tutkintotunnus = '334116';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357106' and versio = 1 and peruste != '10/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357106' and versio=1 and peruste != '10/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357106' and versio > tv.versio)) where tutkintotunnus = '357106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2013' as peruste, hyvaksytty, DATE '2013-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358206' and versio = 1 and peruste != '28/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358206' and versio=1 and peruste != '28/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358206' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358206' and versio > tv.versio)) where tutkintotunnus = '358206';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '35/011/2008' as peruste, hyvaksytty, DATE '2008-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324107' and versio = 1 and peruste != '35/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324107' and versio=1 and peruste != '35/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324107' and versio > tv.versio)) where tutkintotunnus = '324107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324129' and versio = 1 and peruste != '38/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324129' and versio=1 and peruste != '38/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324129' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324129' and versio > tv.versio)) where tutkintotunnus = '324129';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '371110' and versio = 1 and peruste != '19/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='371110' and versio=1 and peruste != '19/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '371110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '371110' and versio > tv.versio)) where tutkintotunnus = '371110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337109' and versio = 1 and peruste != '29/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337109' and versio=1 and peruste != '29/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337109' and versio > tv.versio)) where tutkintotunnus = '337109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384101' and versio = 1 and peruste != '13/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384101' and versio=1 and peruste != '13/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384101' and versio > tv.versio)) where tutkintotunnus = '384101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384112' and versio = 1 and peruste != '12/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384112' and versio=1 and peruste != '12/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384112' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384112' and versio > tv.versio)) where tutkintotunnus = '384112';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '39/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351101' and versio = 1 and peruste != '39/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351101' and versio=1 and peruste != '39/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351101' and versio > tv.versio)) where tutkintotunnus = '351101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2009' as peruste, hyvaksytty, DATE '2009-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387401' and versio = 1 and peruste != '40/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387401' and versio=1 and peruste != '40/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387401' and versio > tv.versio)) where tutkintotunnus = '387401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '35/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352201' and versio = 1 and peruste != '35/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352201' and versio=1 and peruste != '35/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352201' and versio > tv.versio)) where tutkintotunnus = '352201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2013' as peruste, hyvaksytty, DATE '2013-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364301' and versio = 1 and peruste != '7/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364301' and versio=1 and peruste != '7/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364301' and versio > tv.versio)) where tutkintotunnus = '364301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374113' and versio = 1 and peruste != '29/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374113' and versio=1 and peruste != '29/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374113' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374113' and versio > tv.versio)) where tutkintotunnus = '374113';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2005' as peruste, hyvaksytty, DATE '2005-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364202' and versio = 1 and peruste != '15/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364202' and versio=1 and peruste != '15/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364202' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364202' and versio > tv.versio)) where tutkintotunnus = '364202';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '63/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374124' and versio = 1 and peruste != '63/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374124' and versio=1 and peruste != '63/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374124' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374124' and versio > tv.versio)) where tutkintotunnus = '374124';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2013' as peruste, hyvaksytty, DATE '2013-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354401' and versio = 1 and peruste != '3/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354401' and versio=1 and peruste != '3/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354401' and versio > tv.versio)) where tutkintotunnus = '354401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387203' and versio = 1 and peruste != '14/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387203' and versio=1 and peruste != '14/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387203' and versio > tv.versio)) where tutkintotunnus = '387203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '48/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355501' and versio = 1 and peruste != '48/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355501' and versio=1 and peruste != '48/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355501' and versio > tv.versio)) where tutkintotunnus = '355501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '52/011/2002' as peruste, hyvaksytty, DATE '2002-10-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354302' and versio = 1 and peruste != '52/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354302' and versio=1 and peruste != '52/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354302' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354302' and versio > tv.versio)) where tutkintotunnus = '354302';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2006' as peruste, hyvaksytty, DATE '2006-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364103' and versio = 1 and peruste != '25/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364103' and versio=1 and peruste != '25/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364103' and versio > tv.versio)) where tutkintotunnus = '364103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2005' as peruste, hyvaksytty, DATE '2005-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387104' and versio = 1 and peruste != '36/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387104' and versio=1 and peruste != '36/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387104' and versio > tv.versio)) where tutkintotunnus = '387104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2005' as peruste, hyvaksytty, DATE '2005-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355413' and versio = 1 and peruste != '5/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355413' and versio=1 and peruste != '5/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355413' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355413' and versio > tv.versio)) where tutkintotunnus = '355413';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354203' and versio = 1 and peruste != '18/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354203' and versio=1 and peruste != '18/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354203' and versio > tv.versio)) where tutkintotunnus = '354203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357602' and versio = 1 and peruste != '13/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357602' and versio=1 and peruste != '13/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357602' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357602' and versio > tv.versio)) where tutkintotunnus = '357602';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '49/011/2012' as peruste, hyvaksytty, DATE '2013-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354104' and versio = 1 and peruste != '49/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354104' and versio=1 and peruste != '49/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354104' and versio > tv.versio)) where tutkintotunnus = '354104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '039999' and versio = 1 and peruste != '9/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='039999' and versio=1 and peruste != '9/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '039999' and not exists (select 1 from tutkintoversio where tutkintotunnus = '039999' and versio > tv.versio)) where tutkintotunnus = '039999';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2013' as peruste, hyvaksytty, DATE '2013-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367304' and versio = 1 and peruste != '8/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367304' and versio=1 and peruste != '8/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367304' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367304' and versio > tv.versio)) where tutkintotunnus = '367304';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '56/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354115' and versio = 1 and peruste != '56/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354115' and versio=1 and peruste != '56/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354115' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354115' and versio > tv.versio)) where tutkintotunnus = '354115';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2013' as peruste, hyvaksytty, DATE '2013-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377105' and versio = 1 and peruste != '16/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377105' and versio=1 and peruste != '16/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377105' and versio > tv.versio)) where tutkintotunnus = '377105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357404' and versio = 1 and peruste != '53/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357404' and versio=1 and peruste != '53/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357404' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357404' and versio > tv.versio)) where tutkintotunnus = '357404';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355105' and versio = 1 and peruste != '33/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355105' and versio=1 and peruste != '33/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355105' and versio > tv.versio)) where tutkintotunnus = '355105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2004' as peruste, hyvaksytty, DATE '2004-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358504' and versio = 1 and peruste != '46/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358504' and versio=1 and peruste != '46/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358504' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358504' and versio > tv.versio)) where tutkintotunnus = '358504';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2001' as peruste, hyvaksytty, DATE '2001-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357305' and versio = 1 and peruste != '40/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357305' and versio=1 and peruste != '40/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357305' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357305' and versio > tv.versio)) where tutkintotunnus = '357305';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2002' as peruste, hyvaksytty, DATE '2002-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358405' and versio = 1 and peruste != '29/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358405' and versio=1 and peruste != '29/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358405' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358405' and versio > tv.versio)) where tutkintotunnus = '358405';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357206' and versio = 1 and peruste != '20/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357206' and versio=1 and peruste != '20/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357206' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357206' and versio > tv.versio)) where tutkintotunnus = '357206';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334106' and versio = 1 and peruste != '19/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334106' and versio=1 and peruste != '19/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334106' and versio > tv.versio)) where tutkintotunnus = '334106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '48/011/2010' as peruste, hyvaksytty, DATE '2010-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334117' and versio = 1 and peruste != '48/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334117' and versio=1 and peruste != '48/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334117' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334117' and versio > tv.versio)) where tutkintotunnus = '334117';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2006' as peruste, hyvaksytty, DATE '2006-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357107' and versio = 1 and peruste != '11/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357107' and versio=1 and peruste != '11/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357107' and versio > tv.versio)) where tutkintotunnus = '357107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '1/011/2007' as peruste, hyvaksytty, DATE '2007-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324119' and versio = 1 and peruste != '1/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324119' and versio=1 and peruste != '1/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324119' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324119' and versio > tv.versio)) where tutkintotunnus = '324119';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '42/011/2006' as peruste, hyvaksytty, DATE '2006-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384201' and versio = 1 and peruste != '42/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384201' and versio=1 and peruste != '42/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384201' and versio > tv.versio)) where tutkintotunnus = '384201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361101' and versio = 1 and peruste != '29/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361101' and versio=1 and peruste != '29/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361101' and versio > tv.versio)) where tutkintotunnus = '361101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2003' as peruste, hyvaksytty, DATE '2003-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387501' and versio = 1 and peruste != '21/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387501' and versio=1 and peruste != '21/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387501' and versio > tv.versio)) where tutkintotunnus = '387501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '58/011/2000' as peruste, hyvaksytty, DATE '2000-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384113' and versio = 1 and peruste != '58/011/2000';
update tutkintoversio set voimassa_loppupvm = (DATE '2000-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2000-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384113' and versio=1 and peruste != '58/011/2000';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384113' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384113' and versio > tv.versio)) where tutkintotunnus = '384113';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352301' and versio = 1 and peruste != '5/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352301' and versio=1 and peruste != '5/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352301' and versio > tv.versio)) where tutkintotunnus = '352301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2008' as peruste, hyvaksytty, DATE '2008-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364401' and versio = 1 and peruste != '19/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364401' and versio=1 and peruste != '19/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364401' and versio > tv.versio)) where tutkintotunnus = '364401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364302' and versio = 1 and peruste != '46/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364302' and versio=1 and peruste != '46/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364302' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364302' and versio > tv.versio)) where tutkintotunnus = '364302';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2006' as peruste, hyvaksytty, DATE '2006-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354501' and versio = 1 and peruste != '32/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354501' and versio=1 and peruste != '32/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354501' and versio > tv.versio)) where tutkintotunnus = '354501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387303' and versio = 1 and peruste != '31/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387303' and versio=1 and peruste != '31/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387303' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387303' and versio > tv.versio)) where tutkintotunnus = '387303';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2013' as peruste, hyvaksytty, DATE '2013-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374114' and versio = 1 and peruste != '15/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374114' and versio=1 and peruste != '15/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374114' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374114' and versio > tv.versio)) where tutkintotunnus = '374114';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2006' as peruste, hyvaksytty, DATE '2006-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364203' and versio = 1 and peruste != '19/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364203' and versio=1 and peruste != '19/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364203' and versio > tv.versio)) where tutkintotunnus = '364203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '50/011/2001' as peruste, hyvaksytty, DATE '2001-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354402' and versio = 1 and peruste != '50/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354402' and versio=1 and peruste != '50/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354402' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354402' and versio > tv.versio)) where tutkintotunnus = '354402';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321501' and versio = 1 and peruste != '29/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321501' and versio=1 and peruste != '29/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321501' and versio > tv.versio)) where tutkintotunnus = '321501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2003' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357801' and versio = 1 and peruste != '11/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357801' and versio=1 and peruste != '11/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357801' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357801' and versio > tv.versio)) where tutkintotunnus = '357801';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2002' as peruste, hyvaksytty, DATE '2002-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355502' and versio = 1 and peruste != '26/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355502' and versio=1 and peruste != '26/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355502' and versio > tv.versio)) where tutkintotunnus = '355502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2009' as peruste, hyvaksytty, DATE '2009-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358901' and versio = 1 and peruste != '5/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358901' and versio=1 and peruste != '5/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358901' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358901' and versio > tv.versio)) where tutkintotunnus = '358901';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2005' as peruste, hyvaksytty, DATE '2005-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387105' and versio = 1 and peruste != '37/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387105' and versio=1 and peruste != '37/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387105' and versio > tv.versio)) where tutkintotunnus = '387105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2008' as peruste, hyvaksytty, DATE '2009-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357702' and versio = 1 and peruste != '33/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357702' and versio=1 and peruste != '33/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357702' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357702' and versio > tv.versio)) where tutkintotunnus = '357702';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2012' as peruste, hyvaksytty, DATE '1.10.2012', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354314' and versio = 1 and peruste != '37/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '1.10.2012' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1.10.2012' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354314' and versio=1 and peruste != '37/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354314' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354314' and versio > tv.versio)) where tutkintotunnus = '354314';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357603' and versio = 1 and peruste != '30/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357603' and versio=1 and peruste != '30/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357603' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357603' and versio > tv.versio)) where tutkintotunnus = '357603';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2007' as peruste, hyvaksytty, DATE '2007-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354105' and versio = 1 and peruste != '20/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354105' and versio=1 and peruste != '20/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354105' and versio > tv.versio)) where tutkintotunnus = '354105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321204' and versio = 1 and peruste != '30/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321204' and versio=1 and peruste != '30/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321204' and versio > tv.versio)) where tutkintotunnus = '321204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377106' and versio = 1 and peruste != '32/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377106' and versio=1 and peruste != '32/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377106' and versio > tv.versio)) where tutkintotunnus = '377106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357405' and versio = 1 and peruste != '37/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357405' and versio=1 and peruste != '37/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357405' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357405' and versio > tv.versio)) where tutkintotunnus = '357405';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355106' and versio = 1 and peruste != '26/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355106' and versio=1 and peruste != '26/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355106' and versio > tv.versio)) where tutkintotunnus = '355106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2004' as peruste, hyvaksytty, DATE '2004-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358505' and versio = 1 and peruste != '46/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358505' and versio=1 and peruste != '46/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358505' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358505' and versio > tv.versio)) where tutkintotunnus = '358505';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2005' as peruste, hyvaksytty, DATE '2005-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357306' and versio = 1 and peruste != '20/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357306' and versio=1 and peruste != '20/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357306' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357306' and versio > tv.versio)) where tutkintotunnus = '357306';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2014' as peruste, hyvaksytty, DATE '2014-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357207' and versio = 1 and peruste != '7/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357207' and versio=1 and peruste != '7/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357207' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357207' and versio > tv.versio)) where tutkintotunnus = '357207';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2011' as peruste, hyvaksytty, DATE '2011-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334118' and versio = 1 and peruste != '3/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334118' and versio=1 and peruste != '3/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334118' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334118' and versio > tv.versio)) where tutkintotunnus = '334118';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2006' as peruste, hyvaksytty, DATE '2006-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357108' and versio = 1 and peruste != '5/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357108' and versio=1 and peruste != '5/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357108' and versio > tv.versio)) where tutkintotunnus = '357108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '371101' and versio = 1 and peruste != '17/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='371101' and versio=1 and peruste != '17/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '371101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '371101' and versio > tv.versio)) where tutkintotunnus = '371101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2012' as peruste, hyvaksytty, DATE '2012-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384301' and versio = 1 and peruste != '12/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384301' and versio=1 and peruste != '12/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384301' and versio > tv.versio)) where tutkintotunnus = '384301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361201' and versio = 1 and peruste != '2/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361201' and versio=1 and peruste != '2/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361201' and versio > tv.versio)) where tutkintotunnus = '361201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '49/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384202' and versio = 1 and peruste != '49/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384202' and versio=1 and peruste != '49/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384202' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384202' and versio > tv.versio)) where tutkintotunnus = '384202';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351301' and versio = 1 and peruste != '30/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351301' and versio=1 and peruste != '30/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351301' and versio > tv.versio)) where tutkintotunnus = '351301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '6/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352401' and versio = 1 and peruste != '6/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352401' and versio=1 and peruste != '6/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352401' and versio > tv.versio)) where tutkintotunnus = '352401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384103' and versio = 1 and peruste != '12/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384103' and versio=1 and peruste != '12/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384103' and versio > tv.versio)) where tutkintotunnus = '384103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384114' and versio = 1 and peruste != '11/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384114' and versio=1 and peruste != '11/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384114' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384114' and versio > tv.versio)) where tutkintotunnus = '384114';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364402' and versio = 1 and peruste != '54/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364402' and versio=1 and peruste != '54/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364402' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364402' and versio > tv.versio)) where tutkintotunnus = '364402';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2002' as peruste, hyvaksytty, DATE '2002-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354601' and versio = 1 and peruste != '31/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354601' and versio=1 and peruste != '31/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354601' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354601' and versio > tv.versio)) where tutkintotunnus = '354601';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2005' as peruste, hyvaksytty, DATE '2005-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354502' and versio = 1 and peruste != '30/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354502' and versio=1 and peruste != '30/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354502' and versio > tv.versio)) where tutkintotunnus = '354502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '42/011/2012' as peruste, hyvaksytty, DATE '2012-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '387304' and versio = 1 and peruste != '42/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='387304' and versio=1 and peruste != '42/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '387304' and not exists (select 1 from tutkintoversio where tutkintotunnus = '387304' and versio > tv.versio)) where tutkintotunnus = '387304';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2013' as peruste, hyvaksytty, DATE '2013-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374115' and versio = 1 and peruste != '2/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374115' and versio=1 and peruste != '2/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374115' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374115' and versio > tv.versio)) where tutkintotunnus = '374115';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '11/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364204' and versio = 1 and peruste != '11/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364204' and versio=1 and peruste != '11/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364204' and versio > tv.versio)) where tutkintotunnus = '364204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2004' as peruste, hyvaksytty, DATE '2004-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354403' and versio = 1 and peruste != '16/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354403' and versio=1 and peruste != '16/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354403' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354403' and versio > tv.versio)) where tutkintotunnus = '354403';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2003' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357802' and versio = 1 and peruste != '14/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357802' and versio=1 and peruste != '14/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357802' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357802' and versio > tv.versio)) where tutkintotunnus = '357802';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355503' and versio = 1 and peruste != '46/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355503' and versio=1 and peruste != '46/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355503' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355503' and versio > tv.versio)) where tutkintotunnus = '355503';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '35/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358902' and versio = 1 and peruste != '35/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358902' and versio=1 and peruste != '35/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358902' and versio > tv.versio)) where tutkintotunnus = '358902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2007' as peruste, hyvaksytty, DATE '2007-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364105' and versio = 1 and peruste != '24/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364105' and versio=1 and peruste != '24/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364105' and versio > tv.versio)) where tutkintotunnus = '364105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354205' and versio = 1 and peruste != '21/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354205' and versio=1 and peruste != '21/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354205' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354205' and versio > tv.versio)) where tutkintotunnus = '354205';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2005' as peruste, hyvaksytty, DATE '2005-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354106' and versio = 1 and peruste != '3/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354106' and versio=1 and peruste != '3/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354106' and versio > tv.versio)) where tutkintotunnus = '354106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2006' as peruste, hyvaksytty, DATE '2006-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377107' and versio = 1 and peruste != '2/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377107' and versio=1 and peruste != '2/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377107' and versio > tv.versio)) where tutkintotunnus = '377107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '59/011/2010' as peruste, hyvaksytty, DATE '2011-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355107' and versio = 1 and peruste != '59/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355107' and versio=1 and peruste != '59/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355107' and versio > tv.versio)) where tutkintotunnus = '355107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '47/011/2004' as peruste, hyvaksytty, DATE '2004-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358506' and versio = 1 and peruste != '47/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358506' and versio=1 and peruste != '47/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358506' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358506' and versio > tv.versio)) where tutkintotunnus = '358506';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '65/011/2002' as peruste, hyvaksytty, DATE '2003-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334108' and versio = 1 and peruste != '65/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334108' and versio=1 and peruste != '65/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334108' and versio > tv.versio)) where tutkintotunnus = '334108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '55/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334119' and versio = 1 and peruste != '55/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334119' and versio=1 and peruste != '55/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334119' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334119' and versio > tv.versio)) where tutkintotunnus = '334119';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '57/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357109' and versio = 1 and peruste != '57/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357109' and versio=1 and peruste != '57/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357109' and versio > tv.versio)) where tutkintotunnus = '357109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381112' and versio = 1 and peruste != '3/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381112' and versio=1 and peruste != '3/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381112' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381112' and versio > tv.versio)) where tutkintotunnus = '381112';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2005' as peruste, hyvaksytty, DATE '2006-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384401' and versio = 1 and peruste != '38/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384401' and versio=1 and peruste != '38/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384401' and versio > tv.versio)) where tutkintotunnus = '384401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361301' and versio = 1 and peruste != '36/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361301' and versio=1 and peruste != '36/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361301' and versio > tv.versio)) where tutkintotunnus = '361301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2012' as peruste, hyvaksytty, DATE '2012-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384203' and versio = 1 and peruste != '8/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384203' and versio=1 and peruste != '8/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384203' and versio > tv.versio)) where tutkintotunnus = '384203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '35/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351203' and versio = 1 and peruste != '35/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351203' and versio=1 and peruste != '35/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351203' and versio > tv.versio)) where tutkintotunnus = '351203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '121/011/1995' as peruste, hyvaksytty, DATE '1995-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367901' and versio = 1 and peruste != '121/011/1995';
update tutkintoversio set voimassa_loppupvm = (DATE '1995-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1995-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367901' and versio=1 and peruste != '121/011/1995';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367901' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367901' and versio > tv.versio)) where tutkintotunnus = '367901';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2005' as peruste, hyvaksytty, DATE '2005-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364403' and versio = 1 and peruste != '26/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364403' and versio=1 and peruste != '26/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364403' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364403' and versio > tv.versio)) where tutkintotunnus = '364403';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2005' as peruste, hyvaksytty, DATE '2005-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354602' and versio = 1 and peruste != '34/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354602' and versio=1 and peruste != '34/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354602' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354602' and versio > tv.versio)) where tutkintotunnus = '354602';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2008' as peruste, hyvaksytty, DATE '2008-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364304' and versio = 1 and peruste != '3/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364304' and versio=1 and peruste != '3/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364304' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364304' and versio > tv.versio)) where tutkintotunnus = '364304';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321602' and versio = 1 and peruste != '32/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321602' and versio=1 and peruste != '32/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321602' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321602' and versio > tv.versio)) where tutkintotunnus = '321602';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2012' as peruste, hyvaksytty, DATE '2012-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364205' and versio = 1 and peruste != '13/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364205' and versio=1 and peruste != '13/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364205' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364205' and versio > tv.versio)) where tutkintotunnus = '364205';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354404' and versio = 1 and peruste != '28/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354404' and versio=1 and peruste != '28/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354404' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354404' and versio > tv.versio)) where tutkintotunnus = '354404';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2003' as peruste, hyvaksytty, DATE '2003-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357803' and versio = 1 and peruste != '25/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357803' and versio=1 and peruste != '25/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357803' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357803' and versio > tv.versio)) where tutkintotunnus = '357803';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '45/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355504' and versio = 1 and peruste != '45/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355504' and versio=1 and peruste != '45/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355504' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355504' and versio > tv.versio)) where tutkintotunnus = '355504';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2014' as peruste, hyvaksytty, DATE '2014-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364106' and versio = 1 and peruste != '14/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364106' and versio=1 and peruste != '14/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364106' and versio > tv.versio)) where tutkintotunnus = '364106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2002' as peruste, hyvaksytty, DATE '2002-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354206' and versio = 1 and peruste != '25/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354206' and versio=1 and peruste != '25/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354206' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354206' and versio > tv.versio)) where tutkintotunnus = '354206';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354107' and versio = 1 and peruste != '27/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354107' and versio=1 and peruste != '27/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354107' and versio > tv.versio)) where tutkintotunnus = '354107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2010' as peruste, hyvaksytty, DATE '2010-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377108' and versio = 1 and peruste != '28/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377108' and versio=1 and peruste != '28/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377108' and versio > tv.versio)) where tutkintotunnus = '377108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2004' as peruste, hyvaksytty, DATE '2004-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355108' and versio = 1 and peruste != '25/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355108' and versio=1 and peruste != '25/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355108' and versio > tv.versio)) where tutkintotunnus = '355108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '5/011/2002' as peruste, hyvaksytty, DATE '2002-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358408' and versio = 1 and peruste != '5/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358408' and versio=1 and peruste != '5/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358408' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358408' and versio > tv.versio)) where tutkintotunnus = '358408';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2006' as peruste, hyvaksytty, DATE '2006-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334109' and versio = 1 and peruste != '30/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334109' and versio=1 and peruste != '30/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334109' and versio > tv.versio)) where tutkintotunnus = '334109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '44/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384501' and versio = 1 and peruste != '44/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384501' and versio=1 and peruste != '44/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384501' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384501' and versio > tv.versio)) where tutkintotunnus = '384501';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381113' and versio = 1 and peruste != '25/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381113' and versio=1 and peruste != '25/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381113' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381113' and versio > tv.versio)) where tutkintotunnus = '381113';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '22/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361401' and versio = 1 and peruste != '22/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361401' and versio=1 and peruste != '22/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361401' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361401' and versio > tv.versio)) where tutkintotunnus = '361401';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384402' and versio = 1 and peruste != '16/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384402' and versio=1 and peruste != '16/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384402' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384402' and versio > tv.versio)) where tutkintotunnus = '384402';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2003' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354801' and versio = 1 and peruste != '9/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354801' and versio=1 and peruste != '9/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354801' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354801' and versio > tv.versio)) where tutkintotunnus = '354801';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2014' as peruste, hyvaksytty, DATE '2014-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384204' and versio = 1 and peruste != '2/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384204' and versio=1 and peruste != '2/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384204' and versio > tv.versio)) where tutkintotunnus = '384204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361104' and versio = 1 and peruste != '24/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361104' and versio=1 and peruste != '24/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361104' and versio > tv.versio)) where tutkintotunnus = '361104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2008' as peruste, hyvaksytty, DATE '2008-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355901' and versio = 1 and peruste != '2/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355901' and versio=1 and peruste != '2/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355901' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355901' and versio > tv.versio)) where tutkintotunnus = '355901';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2008' as peruste, hyvaksytty, DATE '2008-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354702' and versio = 1 and peruste != '28/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354702' and versio=1 and peruste != '28/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354702' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354702' and versio > tv.versio)) where tutkintotunnus = '354702';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351204' and versio = 1 and peruste != '7/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351204' and versio=1 and peruste != '7/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351204' and versio > tv.versio)) where tutkintotunnus = '351204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367902' and versio = 1 and peruste != '53/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367902' and versio=1 and peruste != '53/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367902' and versio > tv.versio)) where tutkintotunnus = '367902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '29/011/2013' as peruste, hyvaksytty, DATE '2014-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354603' and versio = 1 and peruste != '29/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354603' and versio=1 and peruste != '29/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354603' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354603' and versio > tv.versio)) where tutkintotunnus = '354603';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '43/011/2012' as peruste, hyvaksytty, DATE '2012-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364305' and versio = 1 and peruste != '43/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364305' and versio=1 and peruste != '43/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364305' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364305' and versio > tv.versio)) where tutkintotunnus = '364305';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '61/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374117' and versio = 1 and peruste != '61/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374117' and versio=1 and peruste != '61/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374117' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374117' and versio > tv.versio)) where tutkintotunnus = '374117';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354405' and versio = 1 and peruste != '54/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354405' and versio=1 and peruste != '54/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354405' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354405' and versio > tv.versio)) where tutkintotunnus = '354405';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '47/011/2009' as peruste, hyvaksytty, DATE '2010-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355505' and versio = 1 and peruste != '47/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355505' and versio=1 and peruste != '47/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355505' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355505' and versio > tv.versio)) where tutkintotunnus = '355505';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358904' and versio = 1 and peruste != '54/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358904' and versio=1 and peruste != '54/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358904' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358904' and versio > tv.versio)) where tutkintotunnus = '358904';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364107' and versio = 1 and peruste != '32/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364107' and versio=1 and peruste != '32/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364107' and versio > tv.versio)) where tutkintotunnus = '364107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2008' as peruste, hyvaksytty, DATE '2008-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357705' and versio = 1 and peruste != '25/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357705' and versio=1 and peruste != '25/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357705' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357705' and versio > tv.versio)) where tutkintotunnus = '357705';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354207' and versio = 1 and peruste != '26/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354207' and versio=1 and peruste != '26/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354207' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354207' and versio > tv.versio)) where tutkintotunnus = '354207';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2006' as peruste, hyvaksytty, DATE '2006-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354108' and versio = 1 and peruste != '9/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354108' and versio=1 and peruste != '9/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354108' and versio > tv.versio)) where tutkintotunnus = '354108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355208' and versio = 1 and peruste != '54/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355208' and versio=1 and peruste != '54/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355208' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355208' and versio > tv.versio)) where tutkintotunnus = '355208';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2012' as peruste, hyvaksytty, DATE '2012-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377109' and versio = 1 and peruste != '18/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377109' and versio=1 and peruste != '18/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377109' and versio > tv.versio)) where tutkintotunnus = '377109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2010' as peruste, hyvaksytty, DATE '2010-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355109' and versio = 1 and peruste != '23/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355109' and versio=1 and peruste != '23/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355109' and versio > tv.versio)) where tutkintotunnus = '355109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '41/011/2006' as peruste, hyvaksytty, DATE '2006-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358508' and versio = 1 and peruste != '41/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358508' and versio=1 and peruste != '41/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358508' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358508' and versio > tv.versio)) where tutkintotunnus = '358508';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '49/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358409' and versio = 1 and peruste != '49/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358409' and versio=1 and peruste != '49/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358409' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358409' and versio > tv.versio)) where tutkintotunnus = '358409';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381410' and versio = 1 and peruste != '26/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381410' and versio=1 and peruste != '26/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381410' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381410' and versio > tv.versio)) where tutkintotunnus = '381410';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381201' and versio = 1 and peruste != '17/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381201' and versio=1 and peruste != '17/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381201' and versio > tv.versio)) where tutkintotunnus = '381201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384403' and versio = 1 and peruste != '15/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384403' and versio=1 and peruste != '15/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384403' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384403' and versio > tv.versio)) where tutkintotunnus = '384403';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '22/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351502' and versio = 1 and peruste != '22/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351502' and versio=1 and peruste != '22/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351502' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351502' and versio > tv.versio)) where tutkintotunnus = '351502';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2003' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354802' and versio = 1 and peruste != '12/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354802' and versio=1 and peruste != '12/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354802' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354802' and versio > tv.versio)) where tutkintotunnus = '354802';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352503' and versio = 1 and peruste != '31/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352503' and versio=1 and peruste != '31/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352503' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352503' and versio > tv.versio)) where tutkintotunnus = '352503';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384205' and versio = 1 and peruste != '15/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384205' and versio=1 and peruste != '15/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384205' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384205' and versio > tv.versio)) where tutkintotunnus = '384205';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '57/011/2009' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321901' and versio = 1 and peruste != '57/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321901' and versio=1 and peruste != '57/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321901' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321901' and versio > tv.versio)) where tutkintotunnus = '321901';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355902' and versio = 1 and peruste != '12/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355902' and versio=1 and peruste != '12/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355902' and versio > tv.versio)) where tutkintotunnus = '355902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '39/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384106' and versio = 1 and peruste != '39/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384106' and versio=1 and peruste != '39/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384106' and versio > tv.versio)) where tutkintotunnus = '384106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2008' as peruste, hyvaksytty, DATE '2009-01-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354703' and versio = 1 and peruste != '36/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-01-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-01-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354703' and versio=1 and peruste != '36/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354703' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354703' and versio > tv.versio)) where tutkintotunnus = '354703';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367903' and versio = 1 and peruste != '16/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367903' and versio=1 and peruste != '16/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367903' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367903' and versio > tv.versio)) where tutkintotunnus = '367903';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354604' and versio = 1 and peruste != '13/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354604' and versio=1 and peruste != '13/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354604' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354604' and versio > tv.versio)) where tutkintotunnus = '354604';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351106' and versio = 1 and peruste != '27/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351106' and versio=1 and peruste != '27/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351106' and versio > tv.versio)) where tutkintotunnus = '351106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '7/011/2012' as peruste, hyvaksytty, DATE '2012-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374118' and versio = 1 and peruste != '7/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374118' and versio=1 and peruste != '7/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374118' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374118' and versio > tv.versio)) where tutkintotunnus = '374118';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2012' as peruste, hyvaksytty, DATE '2012-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354406' and versio = 1 and peruste != '17/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354406' and versio=1 and peruste != '17/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354406' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354406' and versio > tv.versio)) where tutkintotunnus = '354406';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '55/011/2002' as peruste, hyvaksytty, DATE '2002-10-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354307' and versio = 1 and peruste != '55/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354307' and versio=1 and peruste != '55/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354307' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354307' and versio > tv.versio)) where tutkintotunnus = '354307';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364108' and versio = 1 and peruste != '30/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364108' and versio=1 and peruste != '30/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364108' and versio > tv.versio)) where tutkintotunnus = '364108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2002' as peruste, hyvaksytty, DATE '2002-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355407' and versio = 1 and peruste != '28/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355407' and versio=1 and peruste != '28/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355407' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355407' and versio > tv.versio)) where tutkintotunnus = '355407';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2006' as peruste, hyvaksytty, DATE '2006-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354109' and versio = 1 and peruste != '4/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354109' and versio=1 and peruste != '4/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354109' and versio > tv.versio)) where tutkintotunnus = '354109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '30/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355209' and versio = 1 and peruste != '30/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355209' and versio=1 and peruste != '30/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355209' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355209' and versio > tv.versio)) where tutkintotunnus = '355209';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351701' and versio = 1 and peruste != '33/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351701' and versio=1 and peruste != '33/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351701' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351701' and versio > tv.versio)) where tutkintotunnus = '351701';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2006' as peruste, hyvaksytty, DATE '2006-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364901' and versio = 1 and peruste != '40/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364901' and versio=1 and peruste != '40/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364901' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364901' and versio > tv.versio)) where tutkintotunnus = '364901';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2013' as peruste, hyvaksytty, DATE '2013-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354803' and versio = 1 and peruste != '34/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354803' and versio=1 and peruste != '34/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354803' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354803' and versio > tv.versio)) where tutkintotunnus = '354803';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '321902' and versio = 1 and peruste != '24/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='321902' and versio=1 and peruste != '24/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '321902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '321902' and versio > tv.versio)) where tutkintotunnus = '321902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2007' as peruste, hyvaksytty, DATE '2007-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355903' and versio = 1 and peruste != '21/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355903' and versio=1 and peruste != '21/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355903' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355903' and versio > tv.versio)) where tutkintotunnus = '355903';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2007' as peruste, hyvaksytty, DATE '2007-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367904' and versio = 1 and peruste != '15/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367904' and versio=1 and peruste != '15/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367904' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367904' and versio > tv.versio)) where tutkintotunnus = '367904';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2001' as peruste, hyvaksytty, DATE '2001-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354605' and versio = 1 and peruste != '31/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354605' and versio=1 and peruste != '31/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354605' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354605' and versio > tv.versio)) where tutkintotunnus = '354605';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351107' and versio = 1 and peruste != '28/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351107' and versio=1 and peruste != '28/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351107' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351107' and versio > tv.versio)) where tutkintotunnus = '351107';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2008' as peruste, hyvaksytty, DATE '2008-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364307' and versio = 1 and peruste != '27/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364307' and versio=1 and peruste != '27/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364307' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364307' and versio > tv.versio)) where tutkintotunnus = '364307';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '9/011/2004' as peruste, hyvaksytty, DATE '2004-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '374119' and versio = 1 and peruste != '9/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='374119' and versio=1 and peruste != '9/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '374119' and not exists (select 1 from tutkintoversio where tutkintotunnus = '374119' and versio > tv.versio)) where tutkintotunnus = '374119';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '22/011/2013' as peruste, hyvaksytty, DATE '2013-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354407' and versio = 1 and peruste != '22/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354407' and versio=1 and peruste != '22/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354407' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354407' and versio > tv.versio)) where tutkintotunnus = '354407';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2004' as peruste, hyvaksytty, DATE '2004-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364109' and versio = 1 and peruste != '26/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364109' and versio=1 and peruste != '26/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364109' and versio > tv.versio)) where tutkintotunnus = '364109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2001' as peruste, hyvaksytty, DATE '2001-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357707' and versio = 1 and peruste != '53/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357707' and versio=1 and peruste != '53/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357707' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357707' and versio > tv.versio)) where tutkintotunnus = '357707';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2008' as peruste, hyvaksytty, DATE '2008-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354209' and versio = 1 and peruste != '20/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354209' and versio=1 and peruste != '20/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354209' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354209' and versio > tv.versio)) where tutkintotunnus = '354209';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381203' and versio = 1 and peruste != '21/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381203' and versio=1 and peruste != '21/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381203' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381203' and versio > tv.versio)) where tutkintotunnus = '381203';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2012' as peruste, hyvaksytty, DATE '2012-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364902' and versio = 1 and peruste != '40/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364902' and versio=1 and peruste != '40/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364902' and versio > tv.versio)) where tutkintotunnus = '364902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351603' and versio = 1 and peruste != '19/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351603' and versio=1 and peruste != '19/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351603' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351603' and versio > tv.versio)) where tutkintotunnus = '351603';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2009' as peruste, hyvaksytty, DATE '2009-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384405' and versio = 1 and peruste != '16/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384405' and versio=1 and peruste != '16/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384405' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384405' and versio > tv.versio)) where tutkintotunnus = '384405';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2003' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354804' and versio = 1 and peruste != '10/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354804' and versio=1 and peruste != '10/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354804' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354804' and versio > tv.versio)) where tutkintotunnus = '354804';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384108' and versio = 1 and peruste != '26/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384108' and versio=1 and peruste != '26/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384108' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384108' and versio > tv.versio)) where tutkintotunnus = '384108';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '24/011/2008' as peruste, hyvaksytty, DATE '2008-10-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354705' and versio = 1 and peruste != '24/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-10-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354705' and versio=1 and peruste != '24/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354705' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354705' and versio > tv.versio)) where tutkintotunnus = '354705';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '51/011/2002' as peruste, hyvaksytty, DATE '2002-11-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367905' and versio = 1 and peruste != '51/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-11-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-11-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367905' and versio=1 and peruste != '51/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367905' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367905' and versio > tv.versio)) where tutkintotunnus = '367905';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '68/011/2002' as peruste, hyvaksytty, DATE '2003-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364308' and versio = 1 and peruste != '68/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364308' and versio=1 and peruste != '68/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364308' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364308' and versio > tv.versio)) where tutkintotunnus = '364308';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '16/011/2012' as peruste, hyvaksytty, DATE '2012-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354408' and versio = 1 and peruste != '16/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354408' and versio=1 and peruste != '16/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354408' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354408' and versio > tv.versio)) where tutkintotunnus = '354408';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2004' as peruste, hyvaksytty, DATE '2004-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354309' and versio = 1 and peruste != '19/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354309' and versio=1 and peruste != '19/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354309' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354309' and versio > tv.versio)) where tutkintotunnus = '354309';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357708' and versio = 1 and peruste != '28/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357708' and versio=1 and peruste != '28/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357708' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357708' and versio > tv.versio)) where tutkintotunnus = '357708';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381402' and versio = 1 and peruste != '36/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381402' and versio=1 and peruste != '36/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381402' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381402' and versio > tv.versio)) where tutkintotunnus = '381402';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381303' and versio = 1 and peruste != '27/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381303' and versio=1 and peruste != '27/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381303' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381303' and versio > tv.versio)) where tutkintotunnus = '381303';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381204' and versio = 1 and peruste != '18/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381204' and versio=1 and peruste != '18/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381204' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381204' and versio > tv.versio)) where tutkintotunnus = '381204';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351703' and versio = 1 and peruste != '33/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351703' and versio=1 and peruste != '33/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351703' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351703' and versio > tv.versio)) where tutkintotunnus = '351703';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381106' and versio = 1 and peruste != '21/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381106' and versio=1 and peruste != '21/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381106' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381106' and versio > tv.versio)) where tutkintotunnus = '381106';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351307' and versio = 1 and peruste != '38/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351307' and versio=1 and peruste != '38/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351307' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351307' and versio > tv.versio)) where tutkintotunnus = '351307';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '45/011/2012' as peruste, hyvaksytty, DATE '2012-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355905' and versio = 1 and peruste != '45/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355905' and versio=1 and peruste != '45/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355905' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355905' and versio > tv.versio)) where tutkintotunnus = '355905';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '384109' and versio = 1 and peruste != '25/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='384109' and versio=1 and peruste != '25/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '384109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '384109' and versio > tv.versio)) where tutkintotunnus = '384109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '39/011/2009' as peruste, hyvaksytty, DATE '2009-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354409' and versio = 1 and peruste != '39/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354409' and versio=1 and peruste != '39/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354409' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354409' and versio > tv.versio)) where tutkintotunnus = '354409';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '41/0112004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357709' and versio = 1 and peruste != '41/0112004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357709' and versio=1 and peruste != '41/0112004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357709' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357709' and versio > tv.versio)) where tutkintotunnus = '357709';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381304' and versio = 1 and peruste != '26/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381304' and versio=1 and peruste != '26/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381304' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381304' and versio > tv.versio)) where tutkintotunnus = '381304';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '1/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352902' and versio = 1 and peruste != '1/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352902' and versio=1 and peruste != '1/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352902' and versio > tv.versio)) where tutkintotunnus = '352902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351704' and versio = 1 and peruste != '37/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351704' and versio=1 and peruste != '37/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351704' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351704' and versio > tv.versio)) where tutkintotunnus = '351704';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '25/011/2012' as peruste, hyvaksytty, DATE '2012-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364904' and versio = 1 and peruste != '25/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364904' and versio=1 and peruste != '25/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364904' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364904' and versio > tv.versio)) where tutkintotunnus = '364904';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351605' and versio = 1 and peruste != '4/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351605' and versio=1 and peruste != '4/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351605' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351605' and versio > tv.versio)) where tutkintotunnus = '351605';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351407' and versio = 1 and peruste != '23/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351407' and versio=1 and peruste != '23/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351407' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351407' and versio > tv.versio)) where tutkintotunnus = '351407';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2014' as peruste, hyvaksytty, DATE '2014-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355906' and versio = 1 and peruste != '15/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355906' and versio=1 and peruste != '15/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355906' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355906' and versio > tv.versio)) where tutkintotunnus = '355906';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '352903' and versio = 1 and peruste != '8/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='352903' and versio=1 and peruste != '8/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '352903' and not exists (select 1 from tutkintoversio where tutkintotunnus = '352903' and versio > tv.versio)) where tutkintotunnus = '352903';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '50/011/2004' as peruste, hyvaksytty, DATE '2005-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364905' and versio = 1 and peruste != '50/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364905' and versio=1 and peruste != '50/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364905' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364905' and versio > tv.versio)) where tutkintotunnus = '364905';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '371109' and versio = 1 and peruste != '12/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='371109' and versio=1 and peruste != '12/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '371109' and not exists (select 1 from tutkintoversio where tutkintotunnus = '371109' and versio > tv.versio)) where tutkintotunnus = '371109';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2001' as peruste, hyvaksytty, DATE '2001-12-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354708' and versio = 1 and peruste != '53/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2001-12-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354708' and versio=1 and peruste != '53/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354708' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354708' and versio > tv.versio)) where tutkintotunnus = '354708';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '31/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '361902' and versio = 1 and peruste != '31/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='361902' and versio=1 and peruste != '31/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '361902' and not exists (select 1 from tutkintoversio where tutkintotunnus = '361902' and versio > tv.versio)) where tutkintotunnus = '361902';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381504' and versio = 1 and peruste != '18/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381504' and versio=1 and peruste != '18/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381504' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381504' and versio > tv.versio)) where tutkintotunnus = '381504';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2013' as peruste, hyvaksytty, DATE '2013-11-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '364906' and versio = 1 and peruste != '27/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-11-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='364906' and versio=1 and peruste != '27/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '364906' and not exists (select 1 from tutkintoversio where tutkintotunnus = '364906' and versio > tv.versio)) where tutkintotunnus = '364906';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '27/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354709' and versio = 1 and peruste != '27/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354709' and versio=1 and peruste != '27/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354709' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354709' and versio > tv.versio)) where tutkintotunnus = '354709';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '351805' and versio = 1 and peruste != '37/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='351805' and versio=1 and peruste != '37/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '351805' and not exists (select 1 from tutkintoversio where tutkintotunnus = '351805' and versio > tv.versio)) where tutkintotunnus = '351805';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2009' as peruste, hyvaksytty, DATE '2009-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '381408' and versio = 1 and peruste != '32/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='381408' and versio=1 and peruste != '32/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '381408' and not exists (select 1 from tutkintoversio where tutkintotunnus = '381408' and versio > tv.versio)) where tutkintotunnus = '381408';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '41/011/2013' as peruste, hyvaksytty, DATE '2014-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337110' and versio = 1 and peruste != '41/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337110' and versio=1 and peruste != '41/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337110' and versio > tv.versio)) where tutkintotunnus = '337110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2014' as peruste, hyvaksytty, DATE '2014-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '317101' and versio = 1 and peruste != '8/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='317101' and versio=1 and peruste != '8/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '317101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '317101' and versio > tv.versio)) where tutkintotunnus = '317101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '32/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324120' and versio = 1 and peruste != '32/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324120' and versio=1 and peruste != '32/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324120' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324120' and versio > tv.versio)) where tutkintotunnus = '324120';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '14/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337111' and versio = 1 and peruste != '14/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337111' and versio=1 and peruste != '14/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337111' and versio > tv.versio)) where tutkintotunnus = '337111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '51/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327101' and versio = 1 and peruste != '51/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327101' and versio=1 and peruste != '51/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327101' and versio > tv.versio)) where tutkintotunnus = '327101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '45/011/2006' as peruste, hyvaksytty, DATE '2006-12-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324110' and versio = 1 and peruste != '45/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-12-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-12-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324110' and versio=1 and peruste != '45/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324110' and versio > tv.versio)) where tutkintotunnus = '324110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '15/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337101' and versio = 1 and peruste != '15/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337101' and versio=1 and peruste != '15/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337101' and versio > tv.versio)) where tutkintotunnus = '337101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '46/011/2010' as peruste, hyvaksytty, DATE '2010-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337112' and versio = 1 and peruste != '46/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337112' and versio=1 and peruste != '46/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337112' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337112' and versio > tv.versio)) where tutkintotunnus = '337112';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2007' as peruste, hyvaksytty, DATE '2008-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357110' and versio = 1 and peruste != '26/011/2007';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357110' and versio=1 and peruste != '26/011/2007';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357110' and versio > tv.versio)) where tutkintotunnus = '357110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358101' and versio = 1 and peruste != '12/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358101' and versio=1 and peruste != '12/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358101' and versio > tv.versio)) where tutkintotunnus = '358101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '17/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '347101' and versio = 1 and peruste != '17/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='347101' and versio=1 and peruste != '17/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '347101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '347101' and versio > tv.versio)) where tutkintotunnus = '347101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '51/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327301' and versio = 1 and peruste != '51/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327301' and versio=1 and peruste != '51/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327301' and versio > tv.versio)) where tutkintotunnus = '327301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '40/011/2013' as peruste, hyvaksytty, DATE '2014-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337102' and versio = 1 and peruste != '40/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337102' and versio=1 and peruste != '40/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337102' and versio > tv.versio)) where tutkintotunnus = '337102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '35/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327114' and versio = 1 and peruste != '35/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327114' and versio=1 and peruste != '35/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327114' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327114' and versio > tv.versio)) where tutkintotunnus = '327114';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2013' as peruste, hyvaksytty, DATE '2013-07-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357111' and versio = 1 and peruste != '13/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-07-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357111' and versio=1 and peruste != '13/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357111' and versio > tv.versio)) where tutkintotunnus = '357111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '50/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324101' and versio = 1 and peruste != '50/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324101' and versio=1 and peruste != '50/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324101' and versio > tv.versio)) where tutkintotunnus = '324101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358102' and versio = 1 and peruste != '13/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358102' and versio=1 and peruste != '13/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358102' and versio > tv.versio)) where tutkintotunnus = '358102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '42/011/2005' as peruste, hyvaksytty, DATE '2006-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327302' and versio = 1 and peruste != '42/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327302' and versio=1 and peruste != '42/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327302' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327302' and versio > tv.versio)) where tutkintotunnus = '327302';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '52/011/97' as peruste, hyvaksytty, DATE '1998-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327104' and versio = 1 and peruste != '52/011/97';
update tutkintoversio set voimassa_loppupvm = (DATE '1998-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1998-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327104' and versio=1 and peruste != '52/011/97';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327104' and versio > tv.versio)) where tutkintotunnus = '327104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '52/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327115' and versio = 1 and peruste != '52/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327115' and versio=1 and peruste != '52/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327115' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327115' and versio > tv.versio)) where tutkintotunnus = '327115';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2011' as peruste, hyvaksytty, DATE '2012-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377110' and versio = 1 and peruste != '33/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2012-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377110' and versio=1 and peruste != '33/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377110' and versio > tv.versio)) where tutkintotunnus = '377110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2011' as peruste, hyvaksytty, DATE '2011-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355110' and versio = 1 and peruste != '4/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355110' and versio=1 and peruste != '4/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355110' and versio > tv.versio)) where tutkintotunnus = '355110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '37/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358410' and versio = 1 and peruste != '37/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358410' and versio=1 and peruste != '37/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358410' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358410' and versio > tv.versio)) where tutkintotunnus = '358410';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2011' as peruste, hyvaksytty, DATE '2011-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334111' and versio = 1 and peruste != '8/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334111' and versio=1 and peruste != '8/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334111' and versio > tv.versio)) where tutkintotunnus = '334111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '44/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357101' and versio = 1 and peruste != '44/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357101' and versio=1 and peruste != '44/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357101' and versio > tv.versio)) where tutkintotunnus = '357101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '48/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358103' and versio = 1 and peruste != '48/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358103' and versio=1 and peruste != '48/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358103' and versio > tv.versio)) where tutkintotunnus = '358103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '36/011/2004' as peruste, hyvaksytty, DATE '2005-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '337104' and versio = 1 and peruste != '36/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='337104' and versio=1 and peruste != '36/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '337104' and not exists (select 1 from tutkintoversio where tutkintotunnus = '337104' and versio > tv.versio)) where tutkintotunnus = '337104';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '54/011/1997' as peruste, hyvaksytty, DATE '1998-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327105' and versio = 1 and peruste != '54/011/1997';
update tutkintoversio set voimassa_loppupvm = (DATE '1998-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '1998-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327105' and versio=1 and peruste != '54/011/1997';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327105' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327105' and versio > tv.versio)) where tutkintotunnus = '327105';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '28/011/2006' as peruste, hyvaksytty, DATE '2006-08-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327116' and versio = 1 and peruste != '28/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327116' and versio=1 and peruste != '28/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327116' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327116' and versio > tv.versio)) where tutkintotunnus = '327116';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '26/011/2008' as peruste, hyvaksytty, DATE '2008-09-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327127' and versio = 1 and peruste != '26/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-09-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-09-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327127' and versio=1 and peruste != '26/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327127' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327127' and versio > tv.versio)) where tutkintotunnus = '327127';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2003' as peruste, hyvaksytty, DATE '2003-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354110' and versio = 1 and peruste != '23/011/2003';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354110' and versio=1 and peruste != '23/011/2003';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354110' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354110' and versio > tv.versio)) where tutkintotunnus = '354110';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '55/011/2012' as peruste, hyvaksytty, DATE '2013-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355210' and versio = 1 and peruste != '55/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355210' and versio=1 and peruste != '55/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355210' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355210' and versio > tv.versio)) where tutkintotunnus = '355210';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '38/011/2006' as peruste, hyvaksytty, DATE '2006-10-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367101' and versio = 1 and peruste != '38/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-10-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-10-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367101' and versio=1 and peruste != '38/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367101' and versio > tv.versio)) where tutkintotunnus = '367101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '2/011/2005' as peruste, hyvaksytty, DATE '2005-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358411' and versio = 1 and peruste != '2/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358411' and versio=1 and peruste != '2/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358411' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358411' and versio > tv.versio)) where tutkintotunnus = '358411';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '19/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357201' and versio = 1 and peruste != '19/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357201' and versio=1 and peruste != '19/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357201' and versio > tv.versio)) where tutkintotunnus = '357201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '66/011/2002' as peruste, hyvaksytty, DATE '2003-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334101' and versio = 1 and peruste != '66/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2003-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2003-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334101' and versio=1 and peruste != '66/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334101' and versio > tv.versio)) where tutkintotunnus = '334101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2012' as peruste, hyvaksytty, DATE '2013-03-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334112' and versio = 1 and peruste != '53/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-03-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-03-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334112' and versio=1 and peruste != '53/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334112' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334112' and versio > tv.versio)) where tutkintotunnus = '334112';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '23/011/2004' as peruste, hyvaksytty, DATE '2004-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357102' and versio = 1 and peruste != '23/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357102' and versio=1 and peruste != '23/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357102' and versio > tv.versio)) where tutkintotunnus = '357102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '13/011/2009' as peruste, hyvaksytty, DATE '2009-06-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324201' and versio = 1 and peruste != '13/011/2009';
update tutkintoversio set voimassa_loppupvm = (DATE '2009-06-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2009-06-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324201' and versio=1 and peruste != '13/011/2009';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324201' and versio > tv.versio)) where tutkintotunnus = '324201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '34/011/2010' as peruste, hyvaksytty, DATE '2010-05-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '327128' and versio = 1 and peruste != '34/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-05-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-05-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='327128' and versio=1 and peruste != '34/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '327128' and not exists (select 1 from tutkintoversio where tutkintotunnus = '327128' and versio > tv.versio)) where tutkintotunnus = '327128';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '20/011/2010' as peruste, hyvaksytty, DATE '2010-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '038411' and versio = 1 and peruste != '20/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2010-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='038411' and versio=1 and peruste != '20/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '038411' and not exists (select 1 from tutkintoversio where tutkintotunnus = '038411' and versio > tv.versio)) where tutkintotunnus = '038411';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '21/011/2013' as peruste, hyvaksytty, DATE '2013-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '354111' and versio = 1 and peruste != '21/011/2013';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='354111' and versio=1 and peruste != '21/011/2013';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '354111' and not exists (select 1 from tutkintoversio where tutkintotunnus = '354111' and versio > tv.versio)) where tutkintotunnus = '354111';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '47/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '377101' and versio = 1 and peruste != '47/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='377101' and versio=1 and peruste != '47/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '377101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '377101' and versio > tv.versio)) where tutkintotunnus = '377101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '18/011/2011' as peruste, hyvaksytty, DATE '2011-09-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355211' and versio = 1 and peruste != '18/011/2011';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-09-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355211' and versio=1 and peruste != '18/011/2011';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355211' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355211' and versio > tv.versio)) where tutkintotunnus = '355211';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '10/011/2008' as peruste, hyvaksytty, DATE '2008-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '355101' and versio = 1 and peruste != '10/011/2008';
update tutkintoversio set voimassa_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2008-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='355101' and versio=1 and peruste != '10/011/2008';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '355101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '355101' and versio > tv.versio)) where tutkintotunnus = '355101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '33/011/2006' as peruste, hyvaksytty, DATE '2006-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367201' and versio = 1 and peruste != '33/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2006-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367201' and versio=1 and peruste != '33/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367201' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367201' and versio > tv.versio)) where tutkintotunnus = '367201';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '58/011/2010' as peruste, hyvaksytty, DATE '2011-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '344101' and versio = 1 and peruste != '58/011/2010';
update tutkintoversio set voimassa_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2011-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='344101' and versio=1 and peruste != '58/011/2010';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '344101' and not exists (select 1 from tutkintoversio where tutkintotunnus = '344101' and versio > tv.versio)) where tutkintotunnus = '344101';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '53/011/2002' as peruste, hyvaksytty, DATE '2002-10-15', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357301' and versio = 1 and peruste != '53/011/2002';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-10-15' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357301' and versio=1 and peruste != '53/011/2002';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357301' and versio > tv.versio)) where tutkintotunnus = '357301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '8/011/2004' as peruste, hyvaksytty, DATE '2004-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '367102' and versio = 1 and peruste != '8/011/2004';
update tutkintoversio set voimassa_loppupvm = (DATE '2004-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2004-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='367102' and versio=1 and peruste != '8/011/2004';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '367102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '367102' and versio > tv.versio)) where tutkintotunnus = '367102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '4/011/2005' as peruste, hyvaksytty, DATE '2005-04-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '358412' and versio = 1 and peruste != '4/011/2005';
update tutkintoversio set voimassa_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2005-04-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='358412' and versio=1 and peruste != '4/011/2005';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '358412' and not exists (select 1 from tutkintoversio where tutkintotunnus = '358412' and versio > tv.versio)) where tutkintotunnus = '358412';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '12/011/2006' as peruste, hyvaksytty, DATE '2007-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '324301' and versio = 1 and peruste != '12/011/2006';
update tutkintoversio set voimassa_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2007-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='324301' and versio=1 and peruste != '12/011/2006';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '324301' and not exists (select 1 from tutkintoversio where tutkintotunnus = '324301' and versio > tv.versio)) where tutkintotunnus = '324301';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '39/011/2012' as peruste, hyvaksytty, DATE '2013-01-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334102' and versio = 1 and peruste != '39/011/2012';
update tutkintoversio set voimassa_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2013-01-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334102' and versio=1 and peruste != '39/011/2012';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334102' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334102' and versio > tv.versio)) where tutkintotunnus = '334102';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '3/011/2014' as peruste, hyvaksytty, DATE '2014-08-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '334113' and versio = 1 and peruste != '3/011/2014';
update tutkintoversio set voimassa_loppupvm = (DATE '2014-08-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2014-08-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='334113' and versio=1 and peruste != '3/011/2014';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '334113' and not exists (select 1 from tutkintoversio where tutkintotunnus = '334113' and versio > tv.versio)) where tutkintotunnus = '334113';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

insert into tutkintoversio (tutkintotunnus, versio, koodistoversio, peruste, hyvaksytty, voimassa_alkupvm, jarjestyskoodistoversio, osajarjestyskoodisto)   select tutkintotunnus, 2 as versio, koodistoversio, '61/011/2001' as peruste, hyvaksytty, DATE '2002-02-01', jarjestyskoodistoversio, osajarjestyskoodisto from tutkintoversio     where tutkintotunnus = '357103' and versio = 1 and peruste != '61/011/2001';
update tutkintoversio set voimassa_loppupvm = (DATE '2002-02-01' - INTERVAL '1 day')::date, siirtymaajan_loppupvm = (DATE '2002-02-01' - INTERVAL '1 day' + (case tutkintotaso when 'perustutkinto' then INTERVAL '10 years' else INTERVAL '2 years' end))::date from nayttotutkinto where nayttotutkinto.tutkintotunnus = tutkintoversio.tutkintotunnus  and tutkintoversio.tutkintotunnus='357103' and versio=1 and peruste != '61/011/2001';
update nayttotutkinto set uusin_versio_id = (select tutkintoversio_id from tutkintoversio tv where tutkintotunnus = '357103' and not exists (select 1 from tutkintoversio where tutkintotunnus = '357103' and versio > tv.versio)) where tutkintotunnus = '357103';
update sopimus_ja_tutkinto set tutkintoversio = tv2.tutkintoversio_id from sopimus_ja_tutkinto st join tutkintoversio tv on st.tutkintoversio = tv.tutkintoversio_id join tutkintoversio tv2 on tv.tutkintotunnus = tv2.tutkintotunnus and tv2.versio = 2 join jarjestamissopimus on st.jarjestamissopimusid = jarjestamissopimus.jarjestamissopimusid where st.sopimus_ja_tutkinto_id = sopimus_ja_tutkinto.sopimus_ja_tutkinto_id and jarjestamissopimus.alkupvm >= '2014-01-01'::date;

